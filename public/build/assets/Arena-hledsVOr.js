import{a as Te,b as xe,d as be,r as L,e as Se,f as ve,I as pe,g as Ae,c as ne,u as oe,j as a,h as ge,i as le,C as me,k as Ce,H as Re}from"./app-CyGFKNgX.js";import{T as Ie}from"./ThemeSwitcher-B6Apegvu.js";/* empty css            */function Oe(b,e){const n=typeof b=="object"?b:{channelName:b},s=n.skip,l=Te(n.ablyId),{channel:h}=xe(n.ablyId,n.channelName),{connectionError:_,channelError:o}=be(n),j=L.useRef(e);L.useEffect(()=>{j.current=e},[e]);const[c,g]=L.useState(h.state);Se(n,w=>{g(w.current)});const{connectionState:d}=ve(h,n.ablyId,s),T=pe.includes(d)||Ae.includes(c)||s;return L.useEffect(()=>T?void 0:((async()=>{await h.presence.enter(j.current)})(),()=>{const N=!pe.includes(l.connection.state);["attached","attaching"].includes(h.state)&&N&&h.presence.leave()}),[T,h,l]),{updateStatus:L.useCallback(async w=>{await h.presence.update(w)},[h]),connectionError:_,channelError:o}}function Pe(b,e){const n=typeof b=="object"?b:{channelName:b},s=n.skip,{channel:l}=xe(n.ablyId,n.channelName),{connectionError:h,channelError:_}=be(n),[o,j]=L.useState([]),c=L.useRef(e);L.useEffect(()=>{c.current=e},[e]);const g=L.useCallback(async k=>{var w;const N=await l.presence.get();j(N),(w=c.current)===null||w===void 0||w.call(c,k)},[l.presence]),d=L.useCallback(async()=>{l.presence.subscribe(["enter","leave","update"],g);const k=await l.presence.get();j(k)},[l.presence,g]),T=L.useCallback(async()=>{l.presence.unsubscribe(["enter","leave","update"],g)},[l.presence,g]);return L.useEffect(()=>{if(!s)return d(),()=>{T()}},[s,d,T]),ve(l,n.ablyId,s),{presenceData:o,connectionError:h,channelError:_}}function Fe(b){const e=ne.c(77),{user:n,opponent:s,score:l,opponentScore:h,timer:_,currentQuestionIndex:o,status:j,opponentPresent:c}=b,g=o===void 0?0:o,{t:d}=oe(),T=n.profile_photo_url||n.avatar;let k;e[0]!==T||e[1]!==n.name?(k=a.jsx("img",{src:T,alt:n.name,className:"h-12 w-12 rounded-full border-2 border-blue-500 object-cover shadow-md"}),e[0]=T,e[1]=n.name,e[2]=k):k=e[2];let w;e[3]===Symbol.for("react.memo_cache_sentinel")?(w=a.jsx("div",{className:"absolute -right-1 -bottom-1 h-4 w-4 rounded-full border-2 border-white bg-green-500 dark:border-slate-900"}),e[3]=w):w=e[3];let N;e[4]!==k?(N=a.jsxs("div",{className:"relative",children:[k,w]}),e[4]=k,e[5]=N):N=e[5];let f;e[6]!==n.name?(f=a.jsx("span",{className:"font-bold text-slate-900 dark:text-white max-w-[100px] truncate",children:n.name}),e[6]=n.name,e[7]=f):f=e[7];let S;e[8]!==d?(S=d("YOU"),e[8]=d,e[9]=S):S=e[9];let I;e[10]!==S?(I=a.jsx("span",{className:"text-xs font-bold text-blue-600 dark:text-blue-400",children:S}),e[10]=S,e[11]=I):I=e[11];let E;e[12]!==f||e[13]!==I?(E=a.jsxs("div",{className:"hidden flex-col md:flex",children:[f,I]}),e[12]=f,e[13]=I,e[14]=E):E=e[14];let A;e[15]!==d?(A=d("Score"),e[15]=d,e[16]=A):A=e[16];let O;e[17]!==A?(O=a.jsx("span",{className:"text-xs font-bold uppercase text-blue-600 dark:text-blue-400",children:A}),e[17]=A,e[18]=O):O=e[18];let W;e[19]!==l?(W=a.jsx("span",{className:"text-xl font-black text-blue-700 dark:text-blue-300",children:l}),e[19]=l,e[20]=W):W=e[20];let Z;e[21]!==O||e[22]!==W?(Z=a.jsxs("div",{className:"ml-2 flex flex-col items-center rounded-lg bg-blue-100 px-3 py-1 dark:bg-blue-900/30",children:[O,W]}),e[21]=O,e[22]=W,e[23]=Z):Z=e[23];let B;e[24]!==Z||e[25]!==N||e[26]!==E?(B=a.jsxs("div",{className:"flex items-center gap-3",children:[N,E,Z]}),e[24]=Z,e[25]=N,e[26]=E,e[27]=B):B=e[27];let D;e[28]!==j||e[29]!==d||e[30]!==_?(D=j==="QUESTION_ACTIVE"||j==="ROUND_RESULT"?a.jsxs("div",{className:`relative flex h-16 w-16 items-center justify-center rounded-full border-4 shadow-xl transition-all duration-300 md:h-20 md:w-20 ${_<=5?"scale-110 border-red-500 bg-red-500/10":"border-white bg-white dark:border-slate-700 dark:bg-slate-800"}`,children:[a.jsx("span",{className:`text-2xl font-black md:text-4xl ${_<=5?"text-red-500":"text-slate-800 dark:text-white"}`,children:_}),a.jsxs("svg",{className:"pointer-events-none absolute inset-0 h-full w-full -rotate-90",viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"stroke-current text-slate-200 opacity-20 dark:text-slate-700",strokeWidth:"8",cx:"50",cy:"50",r:"40",fill:"transparent"}),a.jsx("circle",{className:`stroke-current transition-all duration-1000 ease-linear ${_<=5?"text-red-500":"text-blue-500"}`,strokeWidth:"8",strokeLinecap:"round",cx:"50",cy:"50",r:"40",fill:"transparent",strokeDasharray:"251.2",strokeDashoffset:251.2-251.2*_/15})]})]}):a.jsx("div",{className:"text-2xl font-black text-slate-300 italic md:text-4xl dark:text-slate-700",children:j==="STARTING"?"VS":j==="WAITING_FOR_OPPONENT"?d("WAITING"):""}),e[28]=j,e[29]=d,e[30]=_,e[31]=D):D=e[31];let U;e[32]!==g||e[33]!==d?(U=g?`${d("Round")} ${g}/5`:"",e[32]=g,e[33]=d,e[34]=U):U=e[34];let J;e[35]!==U?(J=a.jsx("div",{className:"mt-1 text-[10px] font-bold tracking-widest text-slate-400 uppercase md:text-xs",children:U}),e[35]=U,e[36]=J):J=e[36];let z;e[37]!==D||e[38]!==J?(z=a.jsxs("div",{className:"flex flex-col items-center",children:[D,J]}),e[37]=D,e[38]=J,e[39]=z):z=e[39];let H;e[40]!==d?(H=d("Score"),e[40]=d,e[41]=H):H=e[41];let $;e[42]!==H?($=a.jsx("span",{className:"text-xs font-bold uppercase text-purple-600 dark:text-purple-400",children:H}),e[42]=H,e[43]=$):$=e[43];let Q;e[44]!==h?(Q=a.jsx("span",{className:"text-xl font-black text-purple-700 dark:text-purple-300",children:h}),e[44]=h,e[45]=Q):Q=e[45];let G;e[46]!==$||e[47]!==Q?(G=a.jsxs("div",{className:"mr-2 flex flex-col items-center rounded-lg bg-purple-100 px-3 py-1 dark:bg-purple-900/30",children:[$,Q]}),e[46]=$,e[47]=Q,e[48]=G):G=e[48];let q;e[49]!==s||e[50]!==d?(q=s?s.name:d("Searching..."),e[49]=s,e[50]=d,e[51]=q):q=e[51];let K;e[52]!==q?(K=a.jsx("span",{className:"font-bold text-slate-900 dark:text-white max-w-[100px] truncate text-right",children:q}),e[52]=q,e[53]=K):K=e[53];let te;e[54]!==d?(te=d("OPPONENT"),e[54]=d,e[55]=te):te=e[55];let r;e[56]!==te?(r=a.jsx("span",{className:"text-xs font-bold text-purple-600 dark:text-purple-400",children:te}),e[56]=te,e[57]=r):r=e[57];let t;e[58]!==K||e[59]!==r?(t=a.jsxs("div",{className:"hidden flex-col items-end md:flex",children:[K,r]}),e[58]=K,e[59]=r,e[60]=t):t=e[60];let i;e[61]!==s?(i=s?a.jsx("img",{src:s.profile_photo_url||s.avatar,alt:s.name,className:"h-12 w-12 rounded-full border-2 border-purple-500 object-cover shadow-md"}):a.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full border-2 border-slate-300 bg-slate-200 dark:border-slate-700 dark:bg-slate-800",children:a.jsx("span",{className:"text-xl",children:"?"})}),e[61]=s,e[62]=i):i=e[62];let u;e[63]!==s||e[64]!==c?(u=s&&a.jsx("div",{className:`absolute -right-1 -bottom-1 h-4 w-4 rounded-full border-2 border-white dark:border-slate-900 ${c?"bg-green-500 shadow-[0_0_10px_rgba(34,197,94,0.6)]":"bg-red-500"}`}),e[63]=s,e[64]=c,e[65]=u):u=e[65];let m;e[66]!==i||e[67]!==u?(m=a.jsxs("div",{className:"relative",children:[i,u]}),e[66]=i,e[67]=u,e[68]=m):m=e[68];let x;e[69]!==G||e[70]!==t||e[71]!==m?(x=a.jsxs("div",{className:"flex items-center gap-3 justify-end",children:[G,t,m]}),e[69]=G,e[70]=t,e[71]=m,e[72]=x):x=e[72];let v;return e[73]!==B||e[74]!==z||e[75]!==x?(v=a.jsx("div",{className:"w-full max-w-4xl z-20 mb-6 px-4",children:a.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-slate-200 bg-white/50 p-4 shadow-lg backdrop-blur-md dark:border-white/10 dark:bg-slate-900/50",children:[B,z,x]})}),e[73]=B,e[74]=z,e[75]=x,e[76]=v):v=e[76],v}const Le={status:"WAITING_FOR_OPPONENT",currentQuestion:null,timer:0,playerScores:{p1:0,p2:0},lastRoundResult:null,winnerId:null,opponentAnswered:!1,hasAnswered:!1,userAnswer:null,opponent:null};function De(b,e){switch(e.type){case"MATCH_FOUND":return{...b,status:"STARTING",opponent:e.payload.opponent};case"GAME_START":return{...b,status:"STARTING"};case"NEW_QUESTION":return{...b,status:"QUESTION_ACTIVE",currentQuestion:e.payload,timer:e.payload.time_limit,hasAnswered:!1,userAnswer:null,opponentAnswered:!1,lastRoundResult:null};case"TICK_TIMER":return{...b,timer:Math.max(b.timer-1,0)};case"OPPONENT_ANSWERED":return{...b,opponentAnswered:!0};case"PLAYER_ANSWERED":return{...b,hasAnswered:!0,userAnswer:e.payload};case"ROUND_RESULT":return{...b,status:"ROUND_RESULT",lastRoundResult:e.payload,playerScores:e.payload.player_scores};case"GAME_OVER":return{...b,status:"GAME_OVER",winnerId:e.payload.winner_id,playerScores:e.payload.final_scores};default:return b}}function Ue(b,e,n,s){const[l,h]=L.useReducer(De,Le);ge(`match:${e}`,c=>{switch(console.log("Event:",c.name,c.data),c.name){case"match-found":h({type:"MATCH_FOUND",payload:c.data});break;case"match:start":h({type:"GAME_START",payload:c.data});break;case"game:question":h({type:"NEW_QUESTION",payload:c.data});break;case"game:answered":c.data.clientId!==String(n)&&h({type:"OPPONENT_ANSWERED"});break;case"game:round_result":h({type:"ROUND_RESULT",payload:c.data}),s&&setTimeout(()=>j(),1500);break;case"game:over":h({type:"GAME_OVER",payload:c.data});break}}),L.useEffect(()=>{let c;return l.status==="QUESTION_ACTIVE"&&l.timer>0&&(c=setInterval(()=>{h({type:"TICK_TIMER"})},1e3)),()=>clearInterval(c)},[l.status,l.timer]),L.useEffect(()=>{(async()=>{try{const d=(await le.get(`/match/${b}/state`)).data;if(d.status==="active"&&d.currentQuestion){const T=Math.floor(Date.now()/1e3),k=d.currentQuestion.sent_at,w=T-k,N=Math.max(d.currentQuestion.time_limit-w,0);h({type:"NEW_QUESTION",payload:{...d.currentQuestion,time_limit:N}}),d.playerScores}}catch(g){console.error("Failed to sync state",g)}})()},[b]);const _=async()=>{try{await le.post(`/match/${b}/start`)}catch(c){console.error(c)}},o=async c=>{if(!l.hasAnswered){h({type:"PLAYER_ANSWERED",payload:c});try{await le.post(`/match/${b}/answer`,{question_id:l.currentQuestion?.question_id,answer_option:c})}catch(g){console.error(g)}}},j=async()=>{try{await le.post(`/match/${b}/next`)}catch(c){console.error(c)}};return{state:l,startGame:_,submitAnswer:o,nextQuestion:j}}var ce={};(function b(e,n,s,l){var h=!!(e.Worker&&e.Blob&&e.Promise&&e.OffscreenCanvas&&e.OffscreenCanvasRenderingContext2D&&e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype.transferControlToOffscreen&&e.URL&&e.URL.createObjectURL),_=typeof Path2D=="function"&&typeof DOMMatrix=="function",o=function(){if(!e.OffscreenCanvas)return!1;try{var r=new OffscreenCanvas(1,1),t=r.getContext("2d");t.fillRect(0,0,1,1);var i=r.transferToImageBitmap();t.createPattern(i,"no-repeat")}catch{return!1}return!0}();function j(){}function c(r){var t=n.exports.Promise,i=t!==void 0?t:e.Promise;return typeof i=="function"?new i(r):(r(j,j),null)}var g=function(r,t){return{transform:function(i){if(r)return i;if(t.has(i))return t.get(i);var u=new OffscreenCanvas(i.width,i.height),m=u.getContext("2d");return m.drawImage(i,0,0),t.set(i,u),u},clear:function(){t.clear()}}}(o,new Map),d=function(){var r=Math.floor(16.666666666666668),t,i,u={},m=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(t=function(x){var v=Math.random();return u[v]=requestAnimationFrame(function p(y){m===y||m+r-1<y?(m=y,delete u[v],x()):u[v]=requestAnimationFrame(p)}),v},i=function(x){u[x]&&cancelAnimationFrame(u[x])}):(t=function(x){return setTimeout(x,r)},i=function(x){return clearTimeout(x)}),{frame:t,cancel:i}}(),T=function(){var r,t,i={};function u(m){function x(v,p){m.postMessage({options:v||{},callback:p})}m.init=function(p){var y=p.transferControlToOffscreen();m.postMessage({canvas:y},[y])},m.fire=function(p,y,C){if(t)return x(p,null),t;var P=Math.random().toString(36).slice(2);return t=c(function(R){function F(V){V.data.callback===P&&(delete i[P],m.removeEventListener("message",F),t=null,g.clear(),C(),R())}m.addEventListener("message",F),x(p,P),i[P]=F.bind(null,{data:{callback:P}})}),t},m.reset=function(){m.postMessage({reset:!0});for(var p in i)i[p](),delete i[p]}}return function(){if(r)return r;if(!s&&h){var m=["var CONFETTI, SIZE = {}, module = {};","("+b.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{r=new Worker(URL.createObjectURL(new Blob([m])))}catch(x){return typeof console<"u"&&typeof console.warn=="function"&&console.warn("ðŸŽŠ Could not load worker",x),null}u(r)}return r}}(),k={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function w(r,t){return t?t(r):r}function N(r){return r!=null}function f(r,t,i){return w(r&&N(r[t])?r[t]:k[t],i)}function S(r){return r<0?0:Math.floor(r)}function I(r,t){return Math.floor(Math.random()*(t-r))+r}function E(r){return parseInt(r,16)}function A(r){return r.map(O)}function O(r){var t=String(r).replace(/[^0-9a-f]/gi,"");return t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),{r:E(t.substring(0,2)),g:E(t.substring(2,4)),b:E(t.substring(4,6))}}function W(r){var t=f(r,"origin",Object);return t.x=f(t,"x",Number),t.y=f(t,"y",Number),t}function Z(r){r.width=document.documentElement.clientWidth,r.height=document.documentElement.clientHeight}function B(r){var t=r.getBoundingClientRect();r.width=t.width,r.height=t.height}function D(r){var t=document.createElement("canvas");return t.style.position="fixed",t.style.top="0px",t.style.left="0px",t.style.pointerEvents="none",t.style.zIndex=r,t}function U(r,t,i,u,m,x,v,p,y){r.save(),r.translate(t,i),r.rotate(x),r.scale(u,m),r.arc(0,0,1,v,p,y),r.restore()}function J(r){var t=r.angle*(Math.PI/180),i=r.spread*(Math.PI/180);return{x:r.x,y:r.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:r.startVelocity*.5+Math.random()*r.startVelocity,angle2D:-t+(.5*i-Math.random()*i),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:r.color,shape:r.shape,tick:0,totalTicks:r.ticks,decay:r.decay,drift:r.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:r.gravity*3,ovalScalar:.6,scalar:r.scalar,flat:r.flat}}function z(r,t){t.x+=Math.cos(t.angle2D)*t.velocity+t.drift,t.y+=Math.sin(t.angle2D)*t.velocity+t.gravity,t.velocity*=t.decay,t.flat?(t.wobble=0,t.wobbleX=t.x+10*t.scalar,t.wobbleY=t.y+10*t.scalar,t.tiltSin=0,t.tiltCos=0,t.random=1):(t.wobble+=t.wobbleSpeed,t.wobbleX=t.x+10*t.scalar*Math.cos(t.wobble),t.wobbleY=t.y+10*t.scalar*Math.sin(t.wobble),t.tiltAngle+=.1,t.tiltSin=Math.sin(t.tiltAngle),t.tiltCos=Math.cos(t.tiltAngle),t.random=Math.random()+2);var i=t.tick++/t.totalTicks,u=t.x+t.random*t.tiltCos,m=t.y+t.random*t.tiltSin,x=t.wobbleX+t.random*t.tiltCos,v=t.wobbleY+t.random*t.tiltSin;if(r.fillStyle="rgba("+t.color.r+", "+t.color.g+", "+t.color.b+", "+(1-i)+")",r.beginPath(),_&&t.shape.type==="path"&&typeof t.shape.path=="string"&&Array.isArray(t.shape.matrix))r.fill(q(t.shape.path,t.shape.matrix,t.x,t.y,Math.abs(x-u)*.1,Math.abs(v-m)*.1,Math.PI/10*t.wobble));else if(t.shape.type==="bitmap"){var p=Math.PI/10*t.wobble,y=Math.abs(x-u)*.1,C=Math.abs(v-m)*.1,P=t.shape.bitmap.width*t.scalar,R=t.shape.bitmap.height*t.scalar,F=new DOMMatrix([Math.cos(p)*y,Math.sin(p)*y,-Math.sin(p)*C,Math.cos(p)*C,t.x,t.y]);F.multiplySelf(new DOMMatrix(t.shape.matrix));var V=r.createPattern(g.transform(t.shape.bitmap),"no-repeat");V.setTransform(F),r.globalAlpha=1-i,r.fillStyle=V,r.fillRect(t.x-P/2,t.y-R/2,P,R),r.globalAlpha=1}else if(t.shape==="circle")r.ellipse?r.ellipse(t.x,t.y,Math.abs(x-u)*t.ovalScalar,Math.abs(v-m)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI):U(r,t.x,t.y,Math.abs(x-u)*t.ovalScalar,Math.abs(v-m)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI);else if(t.shape==="star")for(var M=Math.PI/2*3,Y=4*t.scalar,X=8*t.scalar,ee=t.x,ae=t.y,se=5,re=Math.PI/se;se--;)ee=t.x+Math.cos(M)*X,ae=t.y+Math.sin(M)*X,r.lineTo(ee,ae),M+=re,ee=t.x+Math.cos(M)*Y,ae=t.y+Math.sin(M)*Y,r.lineTo(ee,ae),M+=re;else r.moveTo(Math.floor(t.x),Math.floor(t.y)),r.lineTo(Math.floor(t.wobbleX),Math.floor(m)),r.lineTo(Math.floor(x),Math.floor(v)),r.lineTo(Math.floor(u),Math.floor(t.wobbleY));return r.closePath(),r.fill(),t.tick<t.totalTicks}function H(r,t,i,u,m){var x=t.slice(),v=r.getContext("2d"),p,y,C=c(function(P){function R(){p=y=null,v.clearRect(0,0,u.width,u.height),g.clear(),m(),P()}function F(){s&&!(u.width===l.width&&u.height===l.height)&&(u.width=r.width=l.width,u.height=r.height=l.height),!u.width&&!u.height&&(i(r),u.width=r.width,u.height=r.height),v.clearRect(0,0,u.width,u.height),x=x.filter(function(V){return z(v,V)}),x.length?p=d.frame(F):R()}p=d.frame(F),y=R});return{addFettis:function(P){return x=x.concat(P),C},canvas:r,promise:C,reset:function(){p&&d.cancel(p),y&&y()}}}function $(r,t){var i=!r,u=!!f(t||{},"resize"),m=!1,x=f(t,"disableForReducedMotion",Boolean),v=h&&!!f(t||{},"useWorker"),p=v?T():null,y=i?Z:B,C=r&&p?!!r.__confetti_initialized:!1,P=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,R;function F(M,Y,X){for(var ee=f(M,"particleCount",S),ae=f(M,"angle",Number),se=f(M,"spread",Number),re=f(M,"startVelocity",Number),we=f(M,"decay",Number),ye=f(M,"gravity",Number),Ne=f(M,"drift",Number),de=f(M,"colors",A),ke=f(M,"ticks",Number),ue=f(M,"shapes"),je=f(M,"scalar"),Me=!!f(M,"flat"),he=W(M),fe=ee,ie=[],_e=r.width*he.x,Ee=r.height*he.y;fe--;)ie.push(J({x:_e,y:Ee,angle:ae,spread:se,startVelocity:re,color:de[fe%de.length],shape:ue[I(0,ue.length)],ticks:ke,decay:we,gravity:ye,drift:Ne,scalar:je,flat:Me}));return R?R.addFettis(ie):(R=H(r,ie,y,Y,X),R.promise)}function V(M){var Y=x||f(M,"disableForReducedMotion",Boolean),X=f(M,"zIndex",Number);if(Y&&P)return c(function(re){re()});i&&R?r=R.canvas:i&&!r&&(r=D(X),document.body.appendChild(r)),u&&!C&&y(r);var ee={width:r.width,height:r.height};p&&!C&&p.init(r),C=!0,p&&(r.__confetti_initialized=!0);function ae(){if(p){var re={getBoundingClientRect:function(){if(!i)return r.getBoundingClientRect()}};y(re),p.postMessage({resize:{width:re.width,height:re.height}});return}ee.width=ee.height=null}function se(){R=null,u&&(m=!1,e.removeEventListener("resize",ae)),i&&r&&(document.body.contains(r)&&document.body.removeChild(r),r=null,C=!1)}return u&&!m&&(m=!0,e.addEventListener("resize",ae,!1)),p?p.fire(M,ee,se):F(M,ee,se)}return V.reset=function(){p&&p.reset(),R&&R.reset()},V}var Q;function G(){return Q||(Q=$(null,{useWorker:!0,resize:!0})),Q}function q(r,t,i,u,m,x,v){var p=new Path2D(r),y=new Path2D;y.addPath(p,new DOMMatrix(t));var C=new Path2D;return C.addPath(y,new DOMMatrix([Math.cos(v)*m,Math.sin(v)*m,-Math.sin(v)*x,Math.cos(v)*x,i,u])),C}function K(r){if(!_)throw new Error("path confetti are not supported in this browser");var t,i;typeof r=="string"?t=r:(t=r.path,i=r.matrix);var u=new Path2D(t),m=document.createElement("canvas"),x=m.getContext("2d");if(!i){for(var v=1e3,p=v,y=v,C=0,P=0,R,F,V=0;V<v;V+=2)for(var M=0;M<v;M+=2)x.isPointInPath(u,V,M,"nonzero")&&(p=Math.min(p,V),y=Math.min(y,M),C=Math.max(C,V),P=Math.max(P,M));R=C-p,F=P-y;var Y=10,X=Math.min(Y/R,Y/F);i=[X,0,0,X,-Math.round(R/2+p)*X,-Math.round(F/2+y)*X]}return{type:"path",path:t,matrix:i}}function te(r){var t,i=1,u="#000000",m='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof r=="string"?t=r:(t=r.text,i="scalar"in r?r.scalar:i,m="fontFamily"in r?r.fontFamily:m,u="color"in r?r.color:u);var x=10*i,v=""+x+"px "+m,p=new OffscreenCanvas(x,x),y=p.getContext("2d");y.font=v;var C=y.measureText(t),P=Math.ceil(C.actualBoundingBoxRight+C.actualBoundingBoxLeft),R=Math.ceil(C.actualBoundingBoxAscent+C.actualBoundingBoxDescent),F=2,V=C.actualBoundingBoxLeft+F,M=C.actualBoundingBoxAscent+F;P+=F+F,R+=F+F,p=new OffscreenCanvas(P,R),y=p.getContext("2d"),y.font=v,y.fillStyle=u,y.fillText(t,V,M);var Y=1/i;return{type:"bitmap",bitmap:p.transferToImageBitmap(),matrix:[Y,0,0,Y,-P*Y/2,-R*Y/2]}}n.exports=function(){return G().apply(this,arguments)},n.exports.reset=function(){G().reset()},n.exports.create=$,n.exports.shapeFromPath=K,n.exports.shapeFromText=te})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),ce,!1);const We=ce.exports;ce.exports.create;function Ke(b){const e=ne.c(5),{match:n}=b,s=`match:${n.channel_id}`;let l;e[0]!==n?(l=a.jsx(me,{channelName:"global-presence",children:a.jsx(Be,{match:n})}),e[0]=n,e[1]=l):l=e[1];let h;return e[2]!==s||e[3]!==l?(h=a.jsx(me,{channelName:s,children:l}),e[2]=s,e[3]=l,e[4]=h):h=e[4],h}function Be(b){const e=ne.c(54),{match:n}=b,s=Ce().props.auth.user,{t:l}=oe(),h=n.player1_id===s.id?n.player2:n.player1,_=Number(n.player1_id)===Number(s.id),{state:o,submitAnswer:j}=Ue(n.id,n.channel_id,s.id,_),c=o.opponent||h;Oe(`match:${n.channel_id}`);const{presenceData:g}=Pe(`match:${n.channel_id}`),[d,T]=L.useState(!1);let k;e[0]!==c?.id||e[1]!==g?(k=()=>{const te=g.some(r=>r.clientId===String(c?.id));T(te)},e[0]=c?.id,e[1]=g,e[2]=k):k=e[2];let w;e[3]!==c||e[4]!==g?(w=[g,c],e[3]=c,e[4]=g,e[5]=w):w=e[5],L.useEffect(k,w);const{channel:N}=ge("global-presence");let f;e[6]!==N||e[7]!==s.id||e[8]!==s.name||e[9]!==s.profile_photo_url?(f=()=>{if(N)return N.presence.update({name:s.name,id:s.id,profile_photo_url:s.profile_photo_url,status:"playing"}),()=>{N.presence.update({name:s.name,id:s.id,profile_photo_url:s.profile_photo_url,status:"online"})}},e[6]=N,e[7]=s.id,e[8]=s.name,e[9]=s.profile_photo_url,e[10]=f):f=e[10];let S;e[11]!==N||e[12]!==s?(S=[N,s],e[11]=N,e[12]=s,e[13]=S):S=e[13],L.useEffect(f,S);const I=o.timer,E=o.currentQuestion,A=o.playerScores[n.player1_id===s.id?"p1":"p2"],O=o.playerScores[n.player1_id===s.id?"p2":"p1"],W=o.winnerId===s.id,Z=o.status==="GAME_OVER"&&!o.winnerId;let B;e[14]===Symbol.for("react.memo_cache_sentinel")?(B=a.jsx(Re,{title:"Arena"}),e[14]=B):B=e[14];let D;e[15]===Symbol.for("react.memo_cache_sentinel")?(D=a.jsx("div",{className:"absolute top-4 right-4 z-50 hidden md:block",children:a.jsx(Ie,{})}),e[15]=D):D=e[15];let U;e[16]===Symbol.for("react.memo_cache_sentinel")?(U=a.jsxs("div",{className:"pointer-events-none absolute inset-0 overflow-hidden",children:[a.jsx("div",{className:"absolute top-[-10%] left-[-10%] h-[500px] w-[500px] animate-pulse rounded-full bg-blue-500/20 blur-[100px]"}),a.jsx("div",{className:"absolute right-[-10%] bottom-[-10%] h-[500px] w-[500px] animate-pulse rounded-full bg-purple-500/20 blur-[100px] delay-700"})]}),e[16]=U):U=e[16];const J=E?.round_index;let z;e[17]!==c||e[18]!==d||e[19]!==O||e[20]!==A||e[21]!==o.status||e[22]!==J||e[23]!==I||e[24]!==s?(z=a.jsx(Fe,{user:s,opponent:c,score:A,opponentScore:O,timer:I,currentQuestionIndex:J,status:o.status,opponentPresent:d}),e[17]=c,e[18]=d,e[19]=O,e[20]=A,e[21]=o.status,e[22]=J,e[23]=I,e[24]=s,e[25]=z):z=e[25];let H;e[26]!==o.status||e[27]!==l?(H=o.status==="WAITING_FOR_OPPONENT"&&a.jsxs("div",{className:"animate-in fade-in md:p6 flex flex-1 flex-col items-center justify-center space-y-8 p-4 text-center duration-700 md:p-6",children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"h-24 w-24 rounded-full border-4 border-slate-200 dark:border-slate-800"}),a.jsx("div",{className:"absolute inset-0 h-24 w-24 animate-spin rounded-full border-t-4 border-blue-500"}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsx("svg",{className:"h-8 w-8 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold md:text-3xl",children:l("Searching for Opponent")}),a.jsx("p",{className:"mt-2 text-slate-500 dark:text-slate-400",children:l("Connecting to global matchmaking server...")})]})]}),e[26]=o.status,e[27]=l,e[28]=H):H=e[28];let $;e[29]!==o.status||e[30]!==l?($=o.status==="STARTING"&&a.jsxs("div",{className:"animate-in zoom-in flex flex-1 flex-col items-center justify-center space-y-6 p-8 text-center duration-500",children:[a.jsx("div",{className:"mb-4 text-6xl md:text-8xl",children:"âš”ï¸"}),a.jsx("h1",{className:"animate-bounce bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-4xl font-black text-transparent md:text-6xl dark:from-blue-400 dark:to-purple-500",children:l("MATCH FOUND!")}),a.jsx("p",{className:"text-xl text-slate-600 dark:text-slate-300",children:l("Get Ready...")})]}),e[29]=o.status,e[30]=l,e[31]=$):$=e[31];let Q;e[32]!==E||e[33]!==o.hasAnswered||e[34]!==o.lastRoundResult||e[35]!==o.opponentAnswered||e[36]!==o.status||e[37]!==o.userAnswer||e[38]!==j?(Q=(o.status==="QUESTION_ACTIVE"||o.status==="ROUND_RESULT")&&E&&a.jsx(Qe,{currentQuestion:E,status:o.status,lastRoundResult:o.lastRoundResult,hasAnswered:o.hasAnswered,opponentAnswered:o.opponentAnswered,submitAnswer:j,userAnswer:o.userAnswer}),e[32]=E,e[33]=o.hasAnswered,e[34]=o.lastRoundResult,e[35]=o.opponentAnswered,e[36]=o.status,e[37]=o.userAnswer,e[38]=j,e[39]=Q):Q=e[39];let G;e[40]!==Z||e[41]!==W||e[42]!==O||e[43]!==A||e[44]!==o.status?(G=o.status==="GAME_OVER"&&a.jsx(Ve,{score:A,opponentScore:O,isWinner:W,isDraw:Z}),e[40]=Z,e[41]=W,e[42]=O,e[43]=A,e[44]=o.status,e[45]=G):G=e[45];let q;e[46]!==H||e[47]!==$||e[48]!==Q||e[49]!==G?(q=a.jsx("div",{className:"z-10 flex w-full max-w-4xl flex-1 flex-col justify-center p-2 md:p-4",children:a.jsxs("div",{className:"relative flex min-h-[400px] flex-col overflow-hidden rounded-3xl border border-slate-200 bg-white/80 shadow-2xl backdrop-blur-xl transition-all duration-500 md:min-h-[500px] dark:border-white/10 dark:bg-slate-900/60",children:[H,$,Q,G]})}),e[46]=H,e[47]=$,e[48]=Q,e[49]=G,e[50]=q):q=e[50];let K;return e[51]!==q||e[52]!==z?(K=a.jsxs("div",{className:"relative flex min-h-screen flex-col items-center overflow-hidden bg-slate-50 font-sans text-slate-900 transition-colors duration-300 selection:bg-blue-500 selection:text-white dark:bg-slate-950 dark:text-white",children:[B,D,U,z,q]}),e[51]=q,e[52]=z,e[53]=K):K=e[53],K}const Qe=L.memo(b=>{const e=ne.c(31),{currentQuestion:n,status:s,lastRoundResult:l,hasAnswered:h,opponentAnswered:_,submitAnswer:o,userAnswer:j}=b,{t:c}=oe(),g=$e;let d;e[0]===Symbol.for("react.memo_cache_sentinel")?(d=a.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 animate-gradient-x"}),e[0]=d):d=e[0];let T;e[1]!==n.category?(T=a.jsx("span",{className:"mb-4 inline-block rounded-full bg-blue-100 px-4 py-1 text-xs font-bold tracking-widest text-blue-700 uppercase dark:bg-blue-900/30 dark:text-blue-300",children:n.category}),e[1]=n.category,e[2]=T):T=e[2];let k;e[3]!==n.text?(k=a.jsx("h2",{className:"text-2xl font-black tracking-tight text-slate-800 md:text-4xl md:leading-snug dark:text-slate-100",children:n.text}),e[3]=n.text,e[4]=k):k=e[4];let w;e[5]!==T||e[6]!==k?(w=a.jsxs("div",{className:"relative mb-8 overflow-hidden rounded-2xl bg-gradient-to-br from-indigo-500/10 to-purple-500/10 p-1 shadow-lg backdrop-blur-md dark:from-indigo-500/5 dark:to-purple-500/5",children:[d,a.jsxs("div",{className:"relative rounded-xl bg-white/50 p-6 text-center dark:bg-slate-900/50 md:p-10",children:[T,k]})]}),e[5]=T,e[6]=k,e[7]=w):w=e[7];let N;if(e[8]!==n.options||e[9]!==h||e[10]!==l?.correct_option||e[11]!==s||e[12]!==o||e[13]!==j){let E;e[15]!==h||e[16]!==l?.correct_option||e[17]!==s||e[18]!==o||e[19]!==j?(E=(A,O)=>{const W=j===A,Z=l?.correct_option===A,B=s==="ROUND_RESULT";let D="border-slate-200 bg-white/80 text-slate-700 hover:border-blue-400 hover:bg-blue-50/50 dark:border-slate-700 dark:bg-slate-800/80 dark:text-slate-200 dark:hover:border-blue-500 dark:hover:bg-blue-900/20",U=a.jsx("span",{className:"flex h-8 w-8 items-center justify-center rounded-lg border border-current opacity-70 text-sm font-bold transition-all group-hover:bg-current group-hover:text-white group-hover:border-transparent",children:String.fromCharCode(65+O)});return h&&(D="border-slate-200 bg-slate-50 text-slate-400 cursor-default dark:border-slate-800 dark:bg-slate-900/50 dark:text-slate-600",W&&(D="border-blue-500 bg-blue-100/50 text-blue-700 dark:border-blue-500 dark:bg-blue-900/30 dark:text-blue-300",U=a.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-blue-500 text-white",children:a.jsxs("svg",{className:"h-5 w-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}))),B&&(Z?(D="border-green-500 bg-green-100 text-green-800 shadow-[0_0_20px_rgba(34,197,94,0.3)] scale-[1.02] z-10 dark:border-green-500 dark:bg-green-900/30 dark:text-green-300",U=a.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-green-500 text-white",children:a.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})):W?(D="border-red-500 bg-red-100 text-red-800 opacity-80 dark:border-red-500 dark:bg-red-900/30 dark:text-red-300",U=a.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-red-500 text-white",children:a.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 18L18 6M6 6l12 12"})})})):D="grayscale opacity-50 border-slate-200 bg-slate-50 dark:border-slate-800 dark:bg-slate-900/50"),a.jsxs("button",{onClick:()=>o(A),disabled:h||B,className:`group relative flex items-center gap-4 overflow-hidden rounded-2xl border-2 p-5 text-left transition-all duration-300 shadow-sm ${D}`,style:{animationDelay:g(O)},children:[a.jsx("div",{className:"shrink-0",children:U}),a.jsx("span",{className:"text-lg font-bold tracking-tight md:text-xl",children:A}),!h&&!B&&a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent opacity-0 transition-opacity duration-300 group-hover:opacity-100 -skew-x-12 translate-x-[-100%] group-hover:translate-x-[100%]"})]},O)},e[15]=h,e[16]=l?.correct_option,e[17]=s,e[18]=o,e[19]=j,e[20]=E):E=e[20],N=n.options.map(E),e[8]=n.options,e[9]=h,e[10]=l?.correct_option,e[11]=s,e[12]=o,e[13]=j,e[14]=N}else N=e[14];let f;e[21]!==N?(f=a.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 md:gap-6",children:N}),e[21]=N,e[22]=f):f=e[22];let S;e[23]!==l||e[24]!==_||e[25]!==c?(S=_&&!l&&a.jsx("div",{className:"mt-8 flex justify-center",children:a.jsxs("div",{className:"flex items-center gap-2 rounded-full bg-red-100 px-4 py-2 text-sm font-bold text-red-600 animate-pulse dark:bg-red-900/30 dark:text-red-400",children:[a.jsxs("span",{className:"relative flex h-3 w-3",children:[a.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"}),a.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-red-500"})]}),c("Opponent has answered!")]})}),e[23]=l,e[24]=_,e[25]=c,e[26]=S):S=e[26];let I;return e[27]!==w||e[28]!==f||e[29]!==S?(I=a.jsxs("div",{className:"flex flex-1 flex-col p-4 md:p-8 w-full max-w-4xl mx-auto",children:[w,f,S]}),e[27]=w,e[28]=f,e[29]=S,e[30]=I):I=e[30],I}),Ve=L.memo(b=>{const e=ne.c(33),{score:n,opponentScore:s,isWinner:l,isDraw:h}=b,{t:_}=oe();let o,j;e[0]!==h||e[1]!==l?(o=()=>{l?(new Audio("/sounds/victory.mp3").play().catch(Ge),We({particleCount:150,spread:70,origin:{y:.6},colors:["#3b82f6","#8b5cf6","#10b981","#f59e0b"]})):h||new Audio("/sounds/defeat.mp3").play().catch(ze)},j=[l,h],e[0]=h,e[1]=l,e[2]=o,e[3]=j):(o=e[2],j=e[3]),L.useEffect(o,j);let c;e[4]!==_?(c=_("GAME OVER"),e[4]=_,e[5]=c):c=e[5];let g;e[6]!==c?(g=a.jsx("h1",{className:"text-4xl font-black tracking-tight text-slate-900 uppercase md:text-6xl dark:text-white",children:c}),e[6]=c,e[7]=g):g=e[7];let d;e[8]!==n?(d=a.jsx("div",{className:"text-5xl font-black",children:n}),e[8]=n,e[9]=d):d=e[9];let T;e[10]===Symbol.for("react.memo_cache_sentinel")?(T=a.jsx("div",{className:"text-sm",children:"YOU"}),e[10]=T):T=e[10];let k;e[11]!==d?(k=a.jsxs("div",{className:"flex flex-col items-center",children:[d,T]}),e[11]=d,e[12]=k):k=e[12];let w;e[13]!==s?(w=a.jsx("div",{className:"text-5xl font-black",children:s}),e[13]=s,e[14]=w):w=e[14];let N;e[15]===Symbol.for("react.memo_cache_sentinel")?(N=a.jsx("div",{className:"text-sm",children:"OPPONENT"}),e[15]=N):N=e[15];let f;e[16]!==w?(f=a.jsxs("div",{className:"flex flex-col items-center",children:[w,N]}),e[16]=w,e[17]=f):f=e[17];let S;e[18]!==f||e[19]!==k?(S=a.jsxs("div",{className:"flex w-full items-end justify-center gap-8 md:gap-16",children:[k,f]}),e[18]=f,e[19]=k,e[20]=S):S=e[20];let I;e[21]!==h||e[22]!==l?(I=a.jsx("div",{className:"pt-8 text-3xl font-bold",children:l?a.jsx("span",{className:"text-green-500",children:"VICTORY!"}):h?a.jsx("span",{className:"text-yellow-500",children:"DRAW"}):a.jsx("span",{className:"text-red-500",children:"DEFEAT"})}),e[21]=h,e[22]=l,e[23]=I):I=e[23];let E;e[24]!==_?(E=_("Back to Dashboard"),e[24]=_,e[25]=E):E=e[25];let A;e[26]!==E?(A=a.jsx("button",{onClick:He,className:"rounded-2xl bg-slate-900 px-8 py-4 font-bold text-white shadow-xl hover:scale-105 dark:bg-white dark:text-slate-900",children:E}),e[26]=E,e[27]=A):A=e[27];let O;return e[28]!==S||e[29]!==I||e[30]!==A||e[31]!==g?(O=a.jsxs("div",{className:"animate-in zoom-in flex flex-1 flex-col items-center justify-center space-y-8 p-8 text-center duration-500",children:[g,S,I,A]}),e[28]=S,e[29]=I,e[30]=A,e[31]=g,e[32]=O):O=e[32],O});function $e(b){return`${b*100}ms`}function Ge(b){return console.log("Audio play failed",b)}function ze(b){return console.log("Audio play failed",b)}function He(){return window.location.href="/dashboard"}export{Ke as default};
