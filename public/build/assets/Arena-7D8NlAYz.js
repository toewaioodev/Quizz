import{a as Te,b as xe,d as be,r as U,e as Se,f as ve,I as pe,g as Ae,c as ne,u as oe,j as a,h as ge,i as le,C as me,k as Ce,H as Re}from"./app-Blg_6PfI.js";import{T as Ie}from"./ThemeSwitcher-BV1Gtf_1.js";/* empty css            */function Oe(b,e){const s=typeof b=="object"?b:{channelName:b},n=s.skip,l=Te(s.ablyId),{channel:h}=xe(s.ablyId,s.channelName),{connectionError:E,channelError:o}=be(s),w=U.useRef(e);U.useEffect(()=>{w.current=e},[e]);const[c,g]=U.useState(h.state);Se(s,M=>{g(M.current)});const{connectionState:u}=ve(h,s.ablyId,n),O=pe.includes(u)||Ae.includes(c)||n;return U.useEffect(()=>O?void 0:((async()=>{await h.presence.enter(w.current)})(),()=>{const N=!pe.includes(l.connection.state);["attached","attaching"].includes(h.state)&&N&&h.presence.leave()}),[O,h,l]),{updateStatus:U.useCallback(async M=>{await h.presence.update(M)},[h]),connectionError:E,channelError:o}}function Pe(b,e){const s=typeof b=="object"?b:{channelName:b},n=s.skip,{channel:l}=xe(s.ablyId,s.channelName),{connectionError:h,channelError:E}=be(s),[o,w]=U.useState([]),c=U.useRef(e);U.useEffect(()=>{c.current=e},[e]);const g=U.useCallback(async j=>{var M;const N=await l.presence.get();w(N),(M=c.current)===null||M===void 0||M.call(c,j)},[l.presence]),u=U.useCallback(async()=>{l.presence.subscribe(["enter","leave","update"],g);const j=await l.presence.get();w(j)},[l.presence,g]),O=U.useCallback(async()=>{l.presence.unsubscribe(["enter","leave","update"],g)},[l.presence,g]);return U.useEffect(()=>{if(!n)return u(),()=>{O()}},[n,u,O]),ve(l,s.ablyId,n),{presenceData:o,connectionError:h,channelError:E}}function Fe(b){const e=ne.c(77),{user:s,opponent:n,score:l,opponentScore:h,timer:E,currentQuestionIndex:o,status:w,opponentPresent:c}=b,g=o===void 0?0:o,{t:u}=oe(),O=s.profile_photo_url||s.avatar;let j;e[0]!==O||e[1]!==s.name?(j=a.jsx("img",{src:O,alt:s.name,className:"h-12 w-12 rounded-full border-2 border-blue-500 object-cover shadow-md"}),e[0]=O,e[1]=s.name,e[2]=j):j=e[2];let M;e[3]===Symbol.for("react.memo_cache_sentinel")?(M=a.jsx("div",{className:"absolute -right-1 -bottom-1 h-4 w-4 rounded-full border-2 border-white bg-green-500 dark:border-slate-900"}),e[3]=M):M=e[3];let N;e[4]!==j?(N=a.jsxs("div",{className:"relative",children:[j,M]}),e[4]=j,e[5]=N):N=e[5];let f;e[6]!==s.name?(f=a.jsx("span",{className:"font-bold text-slate-900 dark:text-white max-w-[100px] truncate",children:s.name}),e[6]=s.name,e[7]=f):f=e[7];let S;e[8]!==u?(S=u("YOU"),e[8]=u,e[9]=S):S=e[9];let C;e[10]!==S?(C=a.jsx("span",{className:"text-xs font-bold text-blue-600 dark:text-blue-400",children:S}),e[10]=S,e[11]=C):C=e[11];let _;e[12]!==f||e[13]!==C?(_=a.jsxs("div",{className:"hidden flex-col md:flex",children:[f,C]}),e[12]=f,e[13]=C,e[14]=_):_=e[14];let T;e[15]!==u?(T=u("Score"),e[15]=u,e[16]=T):T=e[16];let A;e[17]!==T?(A=a.jsx("span",{className:"text-xs font-bold uppercase text-blue-600 dark:text-blue-400",children:T}),e[17]=T,e[18]=A):A=e[18];let W;e[19]!==l?(W=a.jsx("span",{className:"text-xl font-black text-blue-700 dark:text-blue-300",children:l}),e[19]=l,e[20]=W):W=e[20];let V;e[21]!==A||e[22]!==W?(V=a.jsxs("div",{className:"ml-2 flex flex-col items-center rounded-lg bg-blue-100 px-3 py-1 dark:bg-blue-900/30",children:[A,W]}),e[21]=A,e[22]=W,e[23]=V):V=e[23];let $;e[24]!==V||e[25]!==N||e[26]!==_?($=a.jsxs("div",{className:"flex items-center gap-3",children:[N,_,V]}),e[24]=V,e[25]=N,e[26]=_,e[27]=$):$=e[27];let Q;e[28]!==w||e[29]!==u||e[30]!==E?(Q=w==="QUESTION_ACTIVE"||w==="ROUND_RESULT"?a.jsxs("div",{className:`relative flex h-16 w-16 items-center justify-center rounded-full border-4 shadow-xl transition-all duration-300 md:h-20 md:w-20 ${E<=5?"scale-110 border-red-500 bg-red-500/10":"border-white bg-white dark:border-slate-700 dark:bg-slate-800"}`,children:[a.jsx("span",{className:`text-2xl font-black md:text-4xl ${E<=5?"text-red-500":"text-slate-800 dark:text-white"}`,children:E}),a.jsxs("svg",{className:"pointer-events-none absolute inset-0 h-full w-full -rotate-90",viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"stroke-current text-slate-200 opacity-20 dark:text-slate-700",strokeWidth:"8",cx:"50",cy:"50",r:"40",fill:"transparent"}),a.jsx("circle",{className:`stroke-current transition-all duration-1000 ease-linear ${E<=5?"text-red-500":"text-blue-500"}`,strokeWidth:"8",strokeLinecap:"round",cx:"50",cy:"50",r:"40",fill:"transparent",strokeDasharray:"251.2",strokeDashoffset:251.2-251.2*E/15})]})]}):a.jsx("div",{className:"text-2xl font-black text-slate-300 italic md:text-4xl dark:text-slate-700",children:w==="STARTING"?"VS":w==="WAITING_FOR_OPPONENT"?u("WAITING"):""}),e[28]=w,e[29]=u,e[30]=E,e[31]=Q):Q=e[31];let H;e[32]!==g||e[33]!==u?(H=g?`${u("Round")} ${g}/5`:"",e[32]=g,e[33]=u,e[34]=H):H=e[34];let Y;e[35]!==H?(Y=a.jsx("div",{className:"mt-1 text-[10px] font-bold tracking-widest text-slate-400 uppercase md:text-xs",children:H}),e[35]=H,e[36]=Y):Y=e[36];let B;e[37]!==Q||e[38]!==Y?(B=a.jsxs("div",{className:"flex flex-col items-center",children:[Q,Y]}),e[37]=Q,e[38]=Y,e[39]=B):B=e[39];let P;e[40]!==u?(P=u("Score"),e[40]=u,e[41]=P):P=e[41];let D;e[42]!==P?(D=a.jsx("span",{className:"text-xs font-bold uppercase text-purple-600 dark:text-purple-400",children:P}),e[42]=P,e[43]=D):D=e[43];let G;e[44]!==h?(G=a.jsx("span",{className:"text-xl font-black text-purple-700 dark:text-purple-300",children:h}),e[44]=h,e[45]=G):G=e[45];let q;e[46]!==D||e[47]!==G?(q=a.jsxs("div",{className:"mr-2 flex flex-col items-center rounded-lg bg-purple-100 px-3 py-1 dark:bg-purple-900/30",children:[D,G]}),e[46]=D,e[47]=G,e[48]=q):q=e[48];let Z;e[49]!==n||e[50]!==u?(Z=n?n.name:u("Searching..."),e[49]=n,e[50]=u,e[51]=Z):Z=e[51];let J;e[52]!==Z?(J=a.jsx("span",{className:"font-bold text-slate-900 dark:text-white max-w-[100px] truncate text-right",children:Z}),e[52]=Z,e[53]=J):J=e[53];let te;e[54]!==u?(te=u("OPPONENT"),e[54]=u,e[55]=te):te=e[55];let r;e[56]!==te?(r=a.jsx("span",{className:"text-xs font-bold text-purple-600 dark:text-purple-400",children:te}),e[56]=te,e[57]=r):r=e[57];let t;e[58]!==J||e[59]!==r?(t=a.jsxs("div",{className:"hidden flex-col items-end md:flex",children:[J,r]}),e[58]=J,e[59]=r,e[60]=t):t=e[60];let i;e[61]!==n?(i=n?a.jsx("img",{src:n.profile_photo_url||n.avatar,alt:n.name,className:"h-12 w-12 rounded-full border-2 border-purple-500 object-cover shadow-md"}):a.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full border-2 border-slate-300 bg-slate-200 dark:border-slate-700 dark:bg-slate-800",children:a.jsx("span",{className:"text-xl",children:"?"})}),e[61]=n,e[62]=i):i=e[62];let d;e[63]!==n||e[64]!==c?(d=n&&a.jsx("div",{className:`absolute -right-1 -bottom-1 h-4 w-4 rounded-full border-2 border-white dark:border-slate-900 ${c?"bg-green-500 shadow-[0_0_10px_rgba(34,197,94,0.6)]":"bg-red-500"}`}),e[63]=n,e[64]=c,e[65]=d):d=e[65];let m;e[66]!==i||e[67]!==d?(m=a.jsxs("div",{className:"relative",children:[i,d]}),e[66]=i,e[67]=d,e[68]=m):m=e[68];let x;e[69]!==q||e[70]!==t||e[71]!==m?(x=a.jsxs("div",{className:"flex items-center gap-3 justify-end",children:[q,t,m]}),e[69]=q,e[70]=t,e[71]=m,e[72]=x):x=e[72];let v;return e[73]!==$||e[74]!==B||e[75]!==x?(v=a.jsx("div",{className:"w-full max-w-4xl z-20 mb-6 px-4",children:a.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-slate-200 bg-white/50 p-4 shadow-lg backdrop-blur-md dark:border-white/10 dark:bg-slate-900/50",children:[$,B,x]})}),e[73]=$,e[74]=B,e[75]=x,e[76]=v):v=e[76],v}const Le={status:"WAITING_FOR_OPPONENT",currentQuestion:null,timer:0,playerScores:{p1:0,p2:0},lastRoundResult:null,winnerId:null,opponentAnswered:!1,hasAnswered:!1,userAnswer:null,opponent:null};function De(b,e){switch(e.type){case"MATCH_FOUND":return{...b,status:"STARTING",opponent:e.payload.opponent};case"GAME_START":return{...b,status:"STARTING"};case"NEW_QUESTION":return{...b,status:"QUESTION_ACTIVE",currentQuestion:e.payload,timer:e.payload.time_limit,hasAnswered:!1,userAnswer:null,opponentAnswered:!1,lastRoundResult:null};case"TICK_TIMER":return{...b,timer:Math.max(b.timer-1,0)};case"OPPONENT_ANSWERED":return{...b,opponentAnswered:!0};case"PLAYER_ANSWERED":return{...b,hasAnswered:!0,userAnswer:e.payload};case"ROUND_RESULT":return{...b,status:"ROUND_RESULT",lastRoundResult:e.payload,playerScores:e.payload.player_scores};case"GAME_OVER":return{...b,status:"GAME_OVER",winnerId:e.payload.winner_id,playerScores:e.payload.final_scores};default:return b}}function Ue(b,e,s,n){const[l,h]=U.useReducer(De,Le);ge(`match:${e}`,c=>{switch(console.log("Event:",c.name,c.data),c.name){case"match-found":h({type:"MATCH_FOUND",payload:c.data});break;case"match:start":h({type:"GAME_START",payload:c.data});break;case"game:question":h({type:"NEW_QUESTION",payload:c.data});break;case"game:answered":c.data.clientId!==String(s)&&h({type:"OPPONENT_ANSWERED"});break;case"game:round_result":h({type:"ROUND_RESULT",payload:c.data}),n&&setTimeout(()=>w(),1500);break;case"game:over":h({type:"GAME_OVER",payload:c.data});break}}),U.useEffect(()=>{let c;return l.status==="QUESTION_ACTIVE"&&l.timer>0&&(c=setInterval(()=>{h({type:"TICK_TIMER"})},1e3)),()=>clearInterval(c)},[l.status,l.timer]),U.useEffect(()=>{(async()=>{try{const u=(await le.get(`/match/${b}/state`)).data;if(u.status==="active"&&u.currentQuestion){const O=Math.floor(Date.now()/1e3),j=u.currentQuestion.sent_at,M=O-j,N=Math.max(u.currentQuestion.time_limit-M,0);h({type:"NEW_QUESTION",payload:{...u.currentQuestion,time_limit:N}}),u.playerScores}}catch(g){console.error("Failed to sync state",g)}})()},[b]);const E=async()=>{try{await le.post(`/match/${b}/start`)}catch(c){console.error(c)}},o=async c=>{if(!l.hasAnswered){h({type:"PLAYER_ANSWERED",payload:c});try{await le.post(`/match/${b}/answer`,{question_id:l.currentQuestion?.question_id,answer_option:c})}catch(g){console.error(g)}}},w=async()=>{try{await le.post(`/match/${b}/next`)}catch(c){console.error(c)}};return{state:l,startGame:E,submitAnswer:o,nextQuestion:w}}var ce={};(function b(e,s,n,l){var h=!!(e.Worker&&e.Blob&&e.Promise&&e.OffscreenCanvas&&e.OffscreenCanvasRenderingContext2D&&e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype.transferControlToOffscreen&&e.URL&&e.URL.createObjectURL),E=typeof Path2D=="function"&&typeof DOMMatrix=="function",o=function(){if(!e.OffscreenCanvas)return!1;try{var r=new OffscreenCanvas(1,1),t=r.getContext("2d");t.fillRect(0,0,1,1);var i=r.transferToImageBitmap();t.createPattern(i,"no-repeat")}catch{return!1}return!0}();function w(){}function c(r){var t=s.exports.Promise,i=t!==void 0?t:e.Promise;return typeof i=="function"?new i(r):(r(w,w),null)}var g=function(r,t){return{transform:function(i){if(r)return i;if(t.has(i))return t.get(i);var d=new OffscreenCanvas(i.width,i.height),m=d.getContext("2d");return m.drawImage(i,0,0),t.set(i,d),d},clear:function(){t.clear()}}}(o,new Map),u=function(){var r=Math.floor(16.666666666666668),t,i,d={},m=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(t=function(x){var v=Math.random();return d[v]=requestAnimationFrame(function p(y){m===y||m+r-1<y?(m=y,delete d[v],x()):d[v]=requestAnimationFrame(p)}),v},i=function(x){d[x]&&cancelAnimationFrame(d[x])}):(t=function(x){return setTimeout(x,r)},i=function(x){return clearTimeout(x)}),{frame:t,cancel:i}}(),O=function(){var r,t,i={};function d(m){function x(v,p){m.postMessage({options:v||{},callback:p})}m.init=function(p){var y=p.transferControlToOffscreen();m.postMessage({canvas:y},[y])},m.fire=function(p,y,R){if(t)return x(p,null),t;var F=Math.random().toString(36).slice(2);return t=c(function(I){function L(z){z.data.callback===F&&(delete i[F],m.removeEventListener("message",L),t=null,g.clear(),R(),I())}m.addEventListener("message",L),x(p,F),i[F]=L.bind(null,{data:{callback:F}})}),t},m.reset=function(){m.postMessage({reset:!0});for(var p in i)i[p](),delete i[p]}}return function(){if(r)return r;if(!n&&h){var m=["var CONFETTI, SIZE = {}, module = {};","("+b.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{r=new Worker(URL.createObjectURL(new Blob([m])))}catch(x){return typeof console<"u"&&typeof console.warn=="function"&&console.warn("ðŸŽŠ Could not load worker",x),null}d(r)}return r}}(),j={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function M(r,t){return t?t(r):r}function N(r){return r!=null}function f(r,t,i){return M(r&&N(r[t])?r[t]:j[t],i)}function S(r){return r<0?0:Math.floor(r)}function C(r,t){return Math.floor(Math.random()*(t-r))+r}function _(r){return parseInt(r,16)}function T(r){return r.map(A)}function A(r){var t=String(r).replace(/[^0-9a-f]/gi,"");return t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),{r:_(t.substring(0,2)),g:_(t.substring(2,4)),b:_(t.substring(4,6))}}function W(r){var t=f(r,"origin",Object);return t.x=f(t,"x",Number),t.y=f(t,"y",Number),t}function V(r){r.width=document.documentElement.clientWidth,r.height=document.documentElement.clientHeight}function $(r){var t=r.getBoundingClientRect();r.width=t.width,r.height=t.height}function Q(r){var t=document.createElement("canvas");return t.style.position="fixed",t.style.top="0px",t.style.left="0px",t.style.pointerEvents="none",t.style.zIndex=r,t}function H(r,t,i,d,m,x,v,p,y){r.save(),r.translate(t,i),r.rotate(x),r.scale(d,m),r.arc(0,0,1,v,p,y),r.restore()}function Y(r){var t=r.angle*(Math.PI/180),i=r.spread*(Math.PI/180);return{x:r.x,y:r.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:r.startVelocity*.5+Math.random()*r.startVelocity,angle2D:-t+(.5*i-Math.random()*i),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:r.color,shape:r.shape,tick:0,totalTicks:r.ticks,decay:r.decay,drift:r.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:r.gravity*3,ovalScalar:.6,scalar:r.scalar,flat:r.flat}}function B(r,t){t.x+=Math.cos(t.angle2D)*t.velocity+t.drift,t.y+=Math.sin(t.angle2D)*t.velocity+t.gravity,t.velocity*=t.decay,t.flat?(t.wobble=0,t.wobbleX=t.x+10*t.scalar,t.wobbleY=t.y+10*t.scalar,t.tiltSin=0,t.tiltCos=0,t.random=1):(t.wobble+=t.wobbleSpeed,t.wobbleX=t.x+10*t.scalar*Math.cos(t.wobble),t.wobbleY=t.y+10*t.scalar*Math.sin(t.wobble),t.tiltAngle+=.1,t.tiltSin=Math.sin(t.tiltAngle),t.tiltCos=Math.cos(t.tiltAngle),t.random=Math.random()+2);var i=t.tick++/t.totalTicks,d=t.x+t.random*t.tiltCos,m=t.y+t.random*t.tiltSin,x=t.wobbleX+t.random*t.tiltCos,v=t.wobbleY+t.random*t.tiltSin;if(r.fillStyle="rgba("+t.color.r+", "+t.color.g+", "+t.color.b+", "+(1-i)+")",r.beginPath(),E&&t.shape.type==="path"&&typeof t.shape.path=="string"&&Array.isArray(t.shape.matrix))r.fill(Z(t.shape.path,t.shape.matrix,t.x,t.y,Math.abs(x-d)*.1,Math.abs(v-m)*.1,Math.PI/10*t.wobble));else if(t.shape.type==="bitmap"){var p=Math.PI/10*t.wobble,y=Math.abs(x-d)*.1,R=Math.abs(v-m)*.1,F=t.shape.bitmap.width*t.scalar,I=t.shape.bitmap.height*t.scalar,L=new DOMMatrix([Math.cos(p)*y,Math.sin(p)*y,-Math.sin(p)*R,Math.cos(p)*R,t.x,t.y]);L.multiplySelf(new DOMMatrix(t.shape.matrix));var z=r.createPattern(g.transform(t.shape.bitmap),"no-repeat");z.setTransform(L),r.globalAlpha=1-i,r.fillStyle=z,r.fillRect(t.x-F/2,t.y-I/2,F,I),r.globalAlpha=1}else if(t.shape==="circle")r.ellipse?r.ellipse(t.x,t.y,Math.abs(x-d)*t.ovalScalar,Math.abs(v-m)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI):H(r,t.x,t.y,Math.abs(x-d)*t.ovalScalar,Math.abs(v-m)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI);else if(t.shape==="star")for(var k=Math.PI/2*3,K=4*t.scalar,X=8*t.scalar,ee=t.x,ae=t.y,se=5,re=Math.PI/se;se--;)ee=t.x+Math.cos(k)*X,ae=t.y+Math.sin(k)*X,r.lineTo(ee,ae),k+=re,ee=t.x+Math.cos(k)*K,ae=t.y+Math.sin(k)*K,r.lineTo(ee,ae),k+=re;else r.moveTo(Math.floor(t.x),Math.floor(t.y)),r.lineTo(Math.floor(t.wobbleX),Math.floor(m)),r.lineTo(Math.floor(x),Math.floor(v)),r.lineTo(Math.floor(d),Math.floor(t.wobbleY));return r.closePath(),r.fill(),t.tick<t.totalTicks}function P(r,t,i,d,m){var x=t.slice(),v=r.getContext("2d"),p,y,R=c(function(F){function I(){p=y=null,v.clearRect(0,0,d.width,d.height),g.clear(),m(),F()}function L(){n&&!(d.width===l.width&&d.height===l.height)&&(d.width=r.width=l.width,d.height=r.height=l.height),!d.width&&!d.height&&(i(r),d.width=r.width,d.height=r.height),v.clearRect(0,0,d.width,d.height),x=x.filter(function(z){return B(v,z)}),x.length?p=u.frame(L):I()}p=u.frame(L),y=I});return{addFettis:function(F){return x=x.concat(F),R},canvas:r,promise:R,reset:function(){p&&u.cancel(p),y&&y()}}}function D(r,t){var i=!r,d=!!f(t||{},"resize"),m=!1,x=f(t,"disableForReducedMotion",Boolean),v=h&&!!f(t||{},"useWorker"),p=v?O():null,y=i?V:$,R=r&&p?!!r.__confetti_initialized:!1,F=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,I;function L(k,K,X){for(var ee=f(k,"particleCount",S),ae=f(k,"angle",Number),se=f(k,"spread",Number),re=f(k,"startVelocity",Number),ye=f(k,"decay",Number),we=f(k,"gravity",Number),Ne=f(k,"drift",Number),de=f(k,"colors",T),ke=f(k,"ticks",Number),ue=f(k,"shapes"),je=f(k,"scalar"),Me=!!f(k,"flat"),he=W(k),fe=ee,ie=[],_e=r.width*he.x,Ee=r.height*he.y;fe--;)ie.push(Y({x:_e,y:Ee,angle:ae,spread:se,startVelocity:re,color:de[fe%de.length],shape:ue[C(0,ue.length)],ticks:ke,decay:ye,gravity:we,drift:Ne,scalar:je,flat:Me}));return I?I.addFettis(ie):(I=P(r,ie,y,K,X),I.promise)}function z(k){var K=x||f(k,"disableForReducedMotion",Boolean),X=f(k,"zIndex",Number);if(K&&F)return c(function(re){re()});i&&I?r=I.canvas:i&&!r&&(r=Q(X),document.body.appendChild(r)),d&&!R&&y(r);var ee={width:r.width,height:r.height};p&&!R&&p.init(r),R=!0,p&&(r.__confetti_initialized=!0);function ae(){if(p){var re={getBoundingClientRect:function(){if(!i)return r.getBoundingClientRect()}};y(re),p.postMessage({resize:{width:re.width,height:re.height}});return}ee.width=ee.height=null}function se(){I=null,d&&(m=!1,e.removeEventListener("resize",ae)),i&&r&&(document.body.contains(r)&&document.body.removeChild(r),r=null,R=!1)}return d&&!m&&(m=!0,e.addEventListener("resize",ae,!1)),p?p.fire(k,ee,se):L(k,ee,se)}return z.reset=function(){p&&p.reset(),I&&I.reset()},z}var G;function q(){return G||(G=D(null,{useWorker:!0,resize:!0})),G}function Z(r,t,i,d,m,x,v){var p=new Path2D(r),y=new Path2D;y.addPath(p,new DOMMatrix(t));var R=new Path2D;return R.addPath(y,new DOMMatrix([Math.cos(v)*m,Math.sin(v)*m,-Math.sin(v)*x,Math.cos(v)*x,i,d])),R}function J(r){if(!E)throw new Error("path confetti are not supported in this browser");var t,i;typeof r=="string"?t=r:(t=r.path,i=r.matrix);var d=new Path2D(t),m=document.createElement("canvas"),x=m.getContext("2d");if(!i){for(var v=1e3,p=v,y=v,R=0,F=0,I,L,z=0;z<v;z+=2)for(var k=0;k<v;k+=2)x.isPointInPath(d,z,k,"nonzero")&&(p=Math.min(p,z),y=Math.min(y,k),R=Math.max(R,z),F=Math.max(F,k));I=R-p,L=F-y;var K=10,X=Math.min(K/I,K/L);i=[X,0,0,X,-Math.round(I/2+p)*X,-Math.round(L/2+y)*X]}return{type:"path",path:t,matrix:i}}function te(r){var t,i=1,d="#000000",m='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof r=="string"?t=r:(t=r.text,i="scalar"in r?r.scalar:i,m="fontFamily"in r?r.fontFamily:m,d="color"in r?r.color:d);var x=10*i,v=""+x+"px "+m,p=new OffscreenCanvas(x,x),y=p.getContext("2d");y.font=v;var R=y.measureText(t),F=Math.ceil(R.actualBoundingBoxRight+R.actualBoundingBoxLeft),I=Math.ceil(R.actualBoundingBoxAscent+R.actualBoundingBoxDescent),L=2,z=R.actualBoundingBoxLeft+L,k=R.actualBoundingBoxAscent+L;F+=L+L,I+=L+L,p=new OffscreenCanvas(F,I),y=p.getContext("2d"),y.font=v,y.fillStyle=d,y.fillText(t,z,k);var K=1/i;return{type:"bitmap",bitmap:p.transferToImageBitmap(),matrix:[K,0,0,K,-F*K/2,-I*K/2]}}s.exports=function(){return q().apply(this,arguments)},s.exports.reset=function(){q().reset()},s.exports.create=D,s.exports.shapeFromPath=J,s.exports.shapeFromText=te})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),ce,!1);const We=ce.exports;ce.exports.create;function Ke(b){const e=ne.c(5),{match:s}=b,n=`match:${s.channel_id}`;let l;e[0]!==s?(l=a.jsx(me,{channelName:"global-presence",children:a.jsx(Be,{match:s})}),e[0]=s,e[1]=l):l=e[1];let h;return e[2]!==n||e[3]!==l?(h=a.jsx(me,{channelName:n,children:l}),e[2]=n,e[3]=l,e[4]=h):h=e[4],h}function Be(b){const e=ne.c(54),{match:s}=b,n=Ce().props.auth.user,{t:l}=oe(),h=s.player1_id===n.id?s.player2:s.player1,E=Number(s.player1_id)===Number(n.id),{state:o,submitAnswer:w}=Ue(s.id,s.channel_id,n.id,E),c=o.opponent||h;Oe(`match:${s.channel_id}`);const{presenceData:g}=Pe(`match:${s.channel_id}`),[u,O]=U.useState(!1);let j;e[0]!==c?.id||e[1]!==g?(j=()=>{const te=g.some(r=>r.clientId===String(c?.id));O(te)},e[0]=c?.id,e[1]=g,e[2]=j):j=e[2];let M;e[3]!==c||e[4]!==g?(M=[g,c],e[3]=c,e[4]=g,e[5]=M):M=e[5],U.useEffect(j,M);const{channel:N}=ge("global-presence");let f;e[6]!==N||e[7]!==n.id||e[8]!==n.name||e[9]!==n.profile_photo_url?(f=()=>{if(N)return N.presence.update({name:n.name,id:n.id,profile_photo_url:n.profile_photo_url,status:"playing"}),()=>{N.presence.update({name:n.name,id:n.id,profile_photo_url:n.profile_photo_url,status:"online"})}},e[6]=N,e[7]=n.id,e[8]=n.name,e[9]=n.profile_photo_url,e[10]=f):f=e[10];let S;e[11]!==N||e[12]!==n?(S=[N,n],e[11]=N,e[12]=n,e[13]=S):S=e[13],U.useEffect(f,S);const C=o.timer,_=o.currentQuestion,T=o.playerScores[s.player1_id===n.id?"p1":"p2"],A=o.playerScores[s.player1_id===n.id?"p2":"p1"],W=o.winnerId===n.id,V=o.status==="GAME_OVER"&&!o.winnerId;let $;e[14]===Symbol.for("react.memo_cache_sentinel")?($=a.jsx(Re,{title:"Arena"}),e[14]=$):$=e[14];let Q;e[15]===Symbol.for("react.memo_cache_sentinel")?(Q=a.jsx("div",{className:"absolute top-4 right-4 z-50 hidden md:block",children:a.jsx(Ie,{})}),e[15]=Q):Q=e[15];let H;e[16]===Symbol.for("react.memo_cache_sentinel")?(H=a.jsxs("div",{className:"pointer-events-none absolute inset-0 overflow-hidden",children:[a.jsx("div",{className:"absolute top-[-10%] left-[-10%] h-[500px] w-[500px] animate-pulse rounded-full bg-blue-500/20 blur-[100px]"}),a.jsx("div",{className:"absolute right-[-10%] bottom-[-10%] h-[500px] w-[500px] animate-pulse rounded-full bg-purple-500/20 blur-[100px] delay-700"})]}),e[16]=H):H=e[16];const Y=_?.round_index;let B;e[17]!==c||e[18]!==u||e[19]!==A||e[20]!==T||e[21]!==o.status||e[22]!==Y||e[23]!==C||e[24]!==n?(B=a.jsx(Fe,{user:n,opponent:c,score:T,opponentScore:A,timer:C,currentQuestionIndex:Y,status:o.status,opponentPresent:u}),e[17]=c,e[18]=u,e[19]=A,e[20]=T,e[21]=o.status,e[22]=Y,e[23]=C,e[24]=n,e[25]=B):B=e[25];let P;e[26]!==o.status||e[27]!==l?(P=o.status==="WAITING_FOR_OPPONENT"&&a.jsxs("div",{className:"animate-in fade-in md:p6 flex flex-1 flex-col items-center justify-center space-y-8 p-4 text-center duration-700 md:p-6",children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"h-24 w-24 rounded-full border-4 border-slate-200 dark:border-slate-800"}),a.jsx("div",{className:"absolute inset-0 h-24 w-24 animate-spin rounded-full border-t-4 border-blue-500"}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsx("svg",{className:"h-8 w-8 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold md:text-3xl",children:l("Searching for Opponent")}),a.jsx("p",{className:"mt-2 text-slate-500 dark:text-slate-400",children:l("Connecting to global matchmaking server...")})]})]}),e[26]=o.status,e[27]=l,e[28]=P):P=e[28];let D;e[29]!==o.status||e[30]!==l?(D=o.status==="STARTING"&&a.jsxs("div",{className:"animate-in zoom-in flex flex-1 flex-col items-center justify-center space-y-6 p-8 text-center duration-500",children:[a.jsx("div",{className:"mb-4 text-6xl md:text-8xl",children:"âš”ï¸"}),a.jsx("h1",{className:"animate-bounce bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-4xl font-black text-transparent md:text-6xl dark:from-blue-400 dark:to-purple-500",children:l("MATCH FOUND!")}),a.jsx("p",{className:"text-xl text-slate-600 dark:text-slate-300",children:l("Get Ready...")})]}),e[29]=o.status,e[30]=l,e[31]=D):D=e[31];let G;e[32]!==_||e[33]!==o.hasAnswered||e[34]!==o.lastRoundResult||e[35]!==o.opponentAnswered||e[36]!==o.status||e[37]!==o.userAnswer||e[38]!==w?(G=(o.status==="QUESTION_ACTIVE"||o.status==="ROUND_RESULT")&&_&&a.jsx(Qe,{currentQuestion:_,status:o.status,lastRoundResult:o.lastRoundResult,hasAnswered:o.hasAnswered,opponentAnswered:o.opponentAnswered,submitAnswer:w,userAnswer:o.userAnswer}),e[32]=_,e[33]=o.hasAnswered,e[34]=o.lastRoundResult,e[35]=o.opponentAnswered,e[36]=o.status,e[37]=o.userAnswer,e[38]=w,e[39]=G):G=e[39];let q;e[40]!==V||e[41]!==W||e[42]!==A||e[43]!==T||e[44]!==o.status?(q=o.status==="GAME_OVER"&&a.jsx(Ve,{score:T,opponentScore:A,isWinner:W,isDraw:V}),e[40]=V,e[41]=W,e[42]=A,e[43]=T,e[44]=o.status,e[45]=q):q=e[45];let Z;e[46]!==P||e[47]!==D||e[48]!==G||e[49]!==q?(Z=a.jsx("div",{className:"z-10 flex w-full max-w-4xl flex-1 flex-col justify-center p-2 md:p-4",children:a.jsxs("div",{className:"relative flex min-h-[400px] flex-col overflow-hidden rounded-3xl border border-slate-200 bg-white/80 shadow-2xl backdrop-blur-xl transition-all duration-500 md:min-h-[500px] dark:border-white/10 dark:bg-slate-900/60",children:[P,D,G,q]})}),e[46]=P,e[47]=D,e[48]=G,e[49]=q,e[50]=Z):Z=e[50];let J;return e[51]!==Z||e[52]!==B?(J=a.jsxs("div",{className:"relative flex min-h-screen flex-col items-center overflow-hidden bg-slate-50 font-sans text-slate-900 transition-colors duration-300 selection:bg-blue-500 selection:text-white dark:bg-slate-950 dark:text-white",children:[$,Q,H,B,Z]}),e[51]=Z,e[52]=B,e[53]=J):J=e[53],J}const Qe=U.memo(b=>{const e=ne.c(33),{currentQuestion:s,status:n,lastRoundResult:l,hasAnswered:h,opponentAnswered:E,submitAnswer:o,userAnswer:w}=b,{t:c,i18n:g}=oe(),u=g.language==="my",O=u&&s.text_my?s.text_my:s.text,j=u&&s.options_my?s.options_my:s.options,M=$e;let N;e[0]===Symbol.for("react.memo_cache_sentinel")?(N=a.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 animate-gradient-x"}),e[0]=N):N=e[0];let f;e[1]!==s.category?(f=a.jsx("span",{className:"mb-4 inline-block rounded-full bg-blue-100 px-4 py-1 text-xs font-bold tracking-widest text-blue-700 uppercase dark:bg-blue-900/30 dark:text-blue-300",children:s.category}),e[1]=s.category,e[2]=f):f=e[2];let S;e[3]!==O?(S=a.jsx("h2",{className:"text-2xl font-black tracking-tight text-slate-800 md:text-4xl md:leading-snug dark:text-slate-100",children:O}),e[3]=O,e[4]=S):S=e[4];let C;e[5]!==f||e[6]!==S?(C=a.jsxs("div",{className:"relative mb-8 overflow-hidden rounded-2xl bg-gradient-to-br from-indigo-500/10 to-purple-500/10 p-1 shadow-lg backdrop-blur-md dark:from-indigo-500/5 dark:to-purple-500/5",children:[N,a.jsxs("div",{className:"relative rounded-xl bg-white/50 p-6 text-center dark:bg-slate-900/50 md:p-10",children:[f,S]})]}),e[5]=f,e[6]=S,e[7]=C):C=e[7];let _;if(e[8]!==s.options||e[9]!==j||e[10]!==h||e[11]!==l?.correct_option||e[12]!==n||e[13]!==o||e[14]!==w){let V;e[16]!==s.options||e[17]!==h||e[18]!==l?.correct_option||e[19]!==n||e[20]!==o||e[21]!==w?(V=($,Q)=>{const H=w===$,Y=l?.correct_option===$,B=n==="ROUND_RESULT";let P="border-slate-200 bg-white/80 text-slate-700 hover:border-blue-400 hover:bg-blue-50/50 dark:border-slate-700 dark:bg-slate-800/80 dark:text-slate-200 dark:hover:border-blue-500 dark:hover:bg-blue-900/20",D=a.jsx("span",{className:"flex h-8 w-8 items-center justify-center rounded-lg border border-current opacity-70 text-sm font-bold transition-all group-hover:bg-current group-hover:text-white group-hover:border-transparent",children:String.fromCharCode(65+Q)});return h&&(P="border-slate-200 bg-slate-50 text-slate-400 cursor-default dark:border-slate-800 dark:bg-slate-900/50 dark:text-slate-600",H&&(P="border-blue-500 bg-blue-100/50 text-blue-700 dark:border-blue-500 dark:bg-blue-900/30 dark:text-blue-300",D=a.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-blue-500 text-white",children:a.jsxs("svg",{className:"h-5 w-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}))),B&&(Y?(P="border-green-500 bg-green-100 text-green-800 shadow-[0_0_20px_rgba(34,197,94,0.3)] scale-[1.02] z-10 dark:border-green-500 dark:bg-green-900/30 dark:text-green-300",D=a.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-green-500 text-white",children:a.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})):H?(P="border-red-500 bg-red-100 text-red-800 opacity-80 dark:border-red-500 dark:bg-red-900/30 dark:text-red-300",D=a.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-red-500 text-white",children:a.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 18L18 6M6 6l12 12"})})})):P="grayscale opacity-50 border-slate-200 bg-slate-50 dark:border-slate-800 dark:bg-slate-900/50"),a.jsxs("button",{onClick:()=>o(s.options[Q]),disabled:h||B,className:`group relative flex items-center gap-4 overflow-hidden rounded-2xl border-2 p-5 text-left transition-all duration-300 shadow-sm ${P}`,style:{animationDelay:M(Q)},children:[a.jsx("div",{className:"shrink-0",children:D}),a.jsx("span",{className:"text-lg font-bold tracking-tight md:text-xl",children:$}),!h&&!B&&a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent opacity-0 transition-opacity duration-300 group-hover:opacity-100 -skew-x-12 translate-x-[-100%] group-hover:translate-x-[100%]"})]},Q)},e[16]=s.options,e[17]=h,e[18]=l?.correct_option,e[19]=n,e[20]=o,e[21]=w,e[22]=V):V=e[22],_=j.map(V),e[8]=s.options,e[9]=j,e[10]=h,e[11]=l?.correct_option,e[12]=n,e[13]=o,e[14]=w,e[15]=_}else _=e[15];let T;e[23]!==_?(T=a.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 md:gap-6",children:_}),e[23]=_,e[24]=T):T=e[24];let A;e[25]!==l||e[26]!==E||e[27]!==c?(A=E&&!l&&a.jsx("div",{className:"mt-8 flex justify-center",children:a.jsxs("div",{className:"flex items-center gap-2 rounded-full bg-red-100 px-4 py-2 text-sm font-bold text-red-600 animate-pulse dark:bg-red-900/30 dark:text-red-400",children:[a.jsxs("span",{className:"relative flex h-3 w-3",children:[a.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"}),a.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-red-500"})]}),c("Opponent has answered!")]})}),e[25]=l,e[26]=E,e[27]=c,e[28]=A):A=e[28];let W;return e[29]!==C||e[30]!==T||e[31]!==A?(W=a.jsxs("div",{className:"flex flex-1 flex-col p-4 md:p-8 w-full max-w-4xl mx-auto",children:[C,T,A]}),e[29]=C,e[30]=T,e[31]=A,e[32]=W):W=e[32],W}),Ve=U.memo(b=>{const e=ne.c(33),{score:s,opponentScore:n,isWinner:l,isDraw:h}=b,{t:E}=oe();let o,w;e[0]!==h||e[1]!==l?(o=()=>{l?(new Audio("/sounds/victory.mp3").play().catch(Ge),We({particleCount:150,spread:70,origin:{y:.6},colors:["#3b82f6","#8b5cf6","#10b981","#f59e0b"]})):h||new Audio("/sounds/defeat.mp3").play().catch(ze)},w=[l,h],e[0]=h,e[1]=l,e[2]=o,e[3]=w):(o=e[2],w=e[3]),U.useEffect(o,w);let c;e[4]!==E?(c=E("GAME OVER"),e[4]=E,e[5]=c):c=e[5];let g;e[6]!==c?(g=a.jsx("h1",{className:"text-4xl font-black tracking-tight text-slate-900 uppercase md:text-6xl dark:text-white",children:c}),e[6]=c,e[7]=g):g=e[7];let u;e[8]!==s?(u=a.jsx("div",{className:"text-5xl font-black",children:s}),e[8]=s,e[9]=u):u=e[9];let O;e[10]===Symbol.for("react.memo_cache_sentinel")?(O=a.jsx("div",{className:"text-sm",children:"YOU"}),e[10]=O):O=e[10];let j;e[11]!==u?(j=a.jsxs("div",{className:"flex flex-col items-center",children:[u,O]}),e[11]=u,e[12]=j):j=e[12];let M;e[13]!==n?(M=a.jsx("div",{className:"text-5xl font-black",children:n}),e[13]=n,e[14]=M):M=e[14];let N;e[15]===Symbol.for("react.memo_cache_sentinel")?(N=a.jsx("div",{className:"text-sm",children:"OPPONENT"}),e[15]=N):N=e[15];let f;e[16]!==M?(f=a.jsxs("div",{className:"flex flex-col items-center",children:[M,N]}),e[16]=M,e[17]=f):f=e[17];let S;e[18]!==f||e[19]!==j?(S=a.jsxs("div",{className:"flex w-full items-end justify-center gap-8 md:gap-16",children:[j,f]}),e[18]=f,e[19]=j,e[20]=S):S=e[20];let C;e[21]!==h||e[22]!==l?(C=a.jsx("div",{className:"pt-8 text-3xl font-bold",children:l?a.jsx("span",{className:"text-green-500",children:"VICTORY!"}):h?a.jsx("span",{className:"text-yellow-500",children:"DRAW"}):a.jsx("span",{className:"text-red-500",children:"DEFEAT"})}),e[21]=h,e[22]=l,e[23]=C):C=e[23];let _;e[24]!==E?(_=E("Back to Lobby"),e[24]=E,e[25]=_):_=e[25];let T;e[26]!==_?(T=a.jsx("button",{onClick:He,className:"rounded-2xl bg-slate-900 px-8 py-4 font-bold text-white shadow-xl hover:scale-105 dark:bg-white dark:text-slate-900",children:_}),e[26]=_,e[27]=T):T=e[27];let A;return e[28]!==S||e[29]!==C||e[30]!==T||e[31]!==g?(A=a.jsxs("div",{className:"animate-in zoom-in flex flex-1 flex-col items-center justify-center space-y-8 p-8 text-center duration-500",children:[g,S,C,T]}),e[28]=S,e[29]=C,e[30]=T,e[31]=g,e[32]=A):A=e[32],A});function $e(b){return`${b*100}ms`}function Ge(b){return console.log("Audio play failed",b)}function ze(b){return console.log("Audio play failed",b)}function He(){return window.location.href="/lobby"}export{Ke as default};
