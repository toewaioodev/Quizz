import{a as Te,b as xe,d as be,r as D,e as Se,f as ge,I as pe,g as Ae,c as ne,u as oe,j as a,h as ve,i as le,C as me,k as Ce,H as Re}from"./app-DiTgd4Ip.js";import{T as Ie}from"./ThemeSwitcher-B4z_sSSn.js";/* empty css            */function Oe(b,e){const n=typeof b=="object"?b:{channelName:b},s=n.skip,l=Te(n.ablyId),{channel:d}=xe(n.ablyId,n.channelName),{connectionError:E,channelError:o}=be(n),v=D.useRef(e);D.useEffect(()=>{v.current=e},[e]);const[c,y]=D.useState(d.state);Se(n,_=>{y(_.current)});const{connectionState:h}=ge(d,n.ablyId,s),O=pe.includes(h)||Ae.includes(c)||s;return D.useEffect(()=>O?void 0:((async()=>{await d.presence.enter(v.current)})(),()=>{const N=!pe.includes(l.connection.state);["attached","attaching"].includes(d.state)&&N&&d.presence.leave()}),[O,d,l]),{updateStatus:D.useCallback(async _=>{await d.presence.update(_)},[d]),connectionError:E,channelError:o}}function Pe(b,e){const n=typeof b=="object"?b:{channelName:b},s=n.skip,{channel:l}=xe(n.ablyId,n.channelName),{connectionError:d,channelError:E}=be(n),[o,v]=D.useState([]),c=D.useRef(e);D.useEffect(()=>{c.current=e},[e]);const y=D.useCallback(async j=>{var _;const N=await l.presence.get();v(N),(_=c.current)===null||_===void 0||_.call(c,j)},[l.presence]),h=D.useCallback(async()=>{l.presence.subscribe(["enter","leave","update"],y);const j=await l.presence.get();v(j)},[l.presence,y]),O=D.useCallback(async()=>{l.presence.unsubscribe(["enter","leave","update"],y)},[l.presence,y]);return D.useEffect(()=>{if(!s)return h(),()=>{O()}},[s,h,O]),ge(l,n.ablyId,s),{presenceData:o,connectionError:d,channelError:E}}function Fe(b){const e=ne.c(77),{user:n,opponent:s,score:l,opponentScore:d,timer:E,currentQuestionIndex:o,status:v,opponentPresent:c}=b,y=o===void 0?0:o,{t:h}=oe(),O=n.profile_photo_url||n.avatar;let j;e[0]!==O||e[1]!==n.name?(j=a.jsx("img",{src:O,alt:n.name,className:"h-12 w-12 rounded-full border-2 border-blue-500 object-cover shadow-md"}),e[0]=O,e[1]=n.name,e[2]=j):j=e[2];let _;e[3]===Symbol.for("react.memo_cache_sentinel")?(_=a.jsx("div",{className:"absolute -right-1 -bottom-1 h-4 w-4 rounded-full border-2 border-white bg-green-500 dark:border-slate-900"}),e[3]=_):_=e[3];let N;e[4]!==j?(N=a.jsxs("div",{className:"relative",children:[j,_]}),e[4]=j,e[5]=N):N=e[5];let m;e[6]!==n.name?(m=a.jsx("span",{className:"font-bold text-slate-900 dark:text-white max-w-[100px] truncate",children:n.name}),e[6]=n.name,e[7]=m):m=e[7];let R;e[8]!==h?(R=h("YOU"),e[8]=h,e[9]=R):R=e[9];let A;e[10]!==R?(A=a.jsx("span",{className:"text-xs font-bold text-blue-600 dark:text-blue-400",children:R}),e[10]=R,e[11]=A):A=e[11];let M;e[12]!==m||e[13]!==A?(M=a.jsxs("div",{className:"hidden flex-col md:flex",children:[m,A]}),e[12]=m,e[13]=A,e[14]=M):M=e[14];let T;e[15]!==h?(T=h("Score"),e[15]=h,e[16]=T):T=e[16];let S;e[17]!==T?(S=a.jsx("span",{className:"text-xs font-bold uppercase text-blue-600 dark:text-blue-400",children:T}),e[17]=T,e[18]=S):S=e[18];let U;e[19]!==l?(U=a.jsx("span",{className:"text-xl font-black text-blue-700 dark:text-blue-300",children:l}),e[19]=l,e[20]=U):U=e[20];let V;e[21]!==S||e[22]!==U?(V=a.jsxs("div",{className:"ml-2 flex flex-col items-center rounded-lg bg-blue-100 px-3 py-1 dark:bg-blue-900/30",children:[S,U]}),e[21]=S,e[22]=U,e[23]=V):V=e[23];let $;e[24]!==V||e[25]!==N||e[26]!==M?($=a.jsxs("div",{className:"flex items-center gap-3",children:[N,M,V]}),e[24]=V,e[25]=N,e[26]=M,e[27]=$):$=e[27];let B;e[28]!==v||e[29]!==h||e[30]!==E?(B=v==="QUESTION_ACTIVE"||v==="ROUND_RESULT"?a.jsxs("div",{className:`relative flex h-16 w-16 items-center justify-center rounded-full border-4 shadow-xl transition-all duration-300 md:h-20 md:w-20 ${E<=5?"scale-110 border-red-500 bg-red-500/10":"border-white bg-white dark:border-slate-700 dark:bg-slate-800"}`,children:[a.jsx("span",{className:`text-2xl font-black md:text-4xl ${E<=5?"text-red-500":"text-slate-800 dark:text-white"}`,children:E}),a.jsxs("svg",{className:"pointer-events-none absolute inset-0 h-full w-full -rotate-90",viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"stroke-current text-slate-200 opacity-20 dark:text-slate-700",strokeWidth:"8",cx:"50",cy:"50",r:"40",fill:"transparent"}),a.jsx("circle",{className:`stroke-current transition-all duration-1000 ease-linear ${E<=5?"text-red-500":"text-blue-500"}`,strokeWidth:"8",strokeLinecap:"round",cx:"50",cy:"50",r:"40",fill:"transparent",strokeDasharray:"251.2",strokeDashoffset:251.2-251.2*E/15})]})]}):a.jsx("div",{className:"text-2xl font-black text-slate-300 italic md:text-4xl dark:text-slate-700",children:v==="STARTING"?"VS":v==="WAITING_FOR_OPPONENT"?h("WAITING"):""}),e[28]=v,e[29]=h,e[30]=E,e[31]=B):B=e[31];let z;e[32]!==y||e[33]!==h?(z=y?`${h("Round")} ${y}/5`:"",e[32]=y,e[33]=h,e[34]=z):z=e[34];let H;e[35]!==z?(H=a.jsx("div",{className:"mt-1 text-[10px] font-bold tracking-widest text-slate-400 uppercase md:text-xs",children:z}),e[35]=z,e[36]=H):H=e[36];let G;e[37]!==B||e[38]!==H?(G=a.jsxs("div",{className:"flex flex-col items-center",children:[B,H]}),e[37]=B,e[38]=H,e[39]=G):G=e[39];let q;e[40]!==h?(q=h("Score"),e[40]=h,e[41]=q):q=e[41];let Q;e[42]!==q?(Q=a.jsx("span",{className:"text-xs font-bold uppercase text-purple-600 dark:text-purple-400",children:q}),e[42]=q,e[43]=Q):Q=e[43];let P;e[44]!==d?(P=a.jsx("span",{className:"text-xl font-black text-purple-700 dark:text-purple-300",children:d}),e[44]=d,e[45]=P):P=e[45];let W;e[46]!==Q||e[47]!==P?(W=a.jsxs("div",{className:"mr-2 flex flex-col items-center rounded-lg bg-purple-100 px-3 py-1 dark:bg-purple-900/30",children:[Q,P]}),e[46]=Q,e[47]=P,e[48]=W):W=e[48];let Y;e[49]!==s||e[50]!==h?(Y=s?s.name:h("Searching..."),e[49]=s,e[50]=h,e[51]=Y):Y=e[51];let J;e[52]!==Y?(J=a.jsx("span",{className:"font-bold text-slate-900 dark:text-white max-w-[100px] truncate text-right",children:Y}),e[52]=Y,e[53]=J):J=e[53];let te;e[54]!==h?(te=h("OPPONENT"),e[54]=h,e[55]=te):te=e[55];let r;e[56]!==te?(r=a.jsx("span",{className:"text-xs font-bold text-purple-600 dark:text-purple-400",children:te}),e[56]=te,e[57]=r):r=e[57];let t;e[58]!==J||e[59]!==r?(t=a.jsxs("div",{className:"hidden flex-col items-end md:flex",children:[J,r]}),e[58]=J,e[59]=r,e[60]=t):t=e[60];let i;e[61]!==s?(i=s?a.jsx("img",{src:s.profile_photo_url||s.avatar,alt:s.name,className:"h-12 w-12 rounded-full border-2 border-purple-500 object-cover shadow-md"}):a.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full border-2 border-slate-300 bg-slate-200 dark:border-slate-700 dark:bg-slate-800",children:a.jsx("span",{className:"text-xl",children:"?"})}),e[61]=s,e[62]=i):i=e[62];let u;e[63]!==s||e[64]!==c?(u=s&&a.jsx("div",{className:`absolute -right-1 -bottom-1 h-4 w-4 rounded-full border-2 border-white dark:border-slate-900 ${c?"bg-green-500 shadow-[0_0_10px_rgba(34,197,94,0.6)]":"bg-red-500"}`}),e[63]=s,e[64]=c,e[65]=u):u=e[65];let p;e[66]!==i||e[67]!==u?(p=a.jsxs("div",{className:"relative",children:[i,u]}),e[66]=i,e[67]=u,e[68]=p):p=e[68];let x;e[69]!==W||e[70]!==t||e[71]!==p?(x=a.jsxs("div",{className:"flex items-center gap-3 justify-end",children:[W,t,p]}),e[69]=W,e[70]=t,e[71]=p,e[72]=x):x=e[72];let g;return e[73]!==$||e[74]!==G||e[75]!==x?(g=a.jsx("div",{className:"w-full max-w-4xl z-20 mb-6 px-4",children:a.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-slate-200 bg-white/50 p-4 shadow-lg backdrop-blur-md dark:border-white/10 dark:bg-slate-900/50",children:[$,G,x]})}),e[73]=$,e[74]=G,e[75]=x,e[76]=g):g=e[76],g}const Le={status:"WAITING_FOR_OPPONENT",currentQuestion:null,timer:0,playerScores:{p1:0,p2:0},lastRoundResult:null,winnerId:null,opponentAnswered:!1,hasAnswered:!1,userAnswer:null,opponent:null};function De(b,e){switch(e.type){case"MATCH_FOUND":return{...b,status:"STARTING",opponent:e.payload.opponent};case"GAME_START":return{...b,status:"STARTING"};case"NEW_QUESTION":return{...b,status:"QUESTION_ACTIVE",currentQuestion:e.payload,timer:e.payload.time_limit,hasAnswered:!1,userAnswer:null,opponentAnswered:!1,lastRoundResult:null};case"TICK_TIMER":return{...b,timer:Math.max(b.timer-1,0)};case"OPPONENT_ANSWERED":return{...b,opponentAnswered:!0};case"PLAYER_ANSWERED":return{...b,hasAnswered:!0,userAnswer:e.payload};case"ROUND_RESULT":return{...b,status:"ROUND_RESULT",lastRoundResult:e.payload,playerScores:e.payload.player_scores};case"GAME_OVER":return{...b,status:"GAME_OVER",winnerId:e.payload.winner_id,playerScores:e.payload.final_scores};default:return b}}function Ue(b,e,n,s){const[l,d]=D.useReducer(De,Le);ve(`match:${e}`,c=>{switch(console.log("Event:",c.name,c.data),c.name){case"match-found":d({type:"MATCH_FOUND",payload:c.data});break;case"match:start":d({type:"GAME_START",payload:c.data});break;case"game:question":d({type:"NEW_QUESTION",payload:c.data});break;case"game:answered":c.data.clientId!==String(n)&&d({type:"OPPONENT_ANSWERED"});break;case"game:round_result":d({type:"ROUND_RESULT",payload:c.data}),s&&setTimeout(()=>v(),1500);break;case"game:over":d({type:"GAME_OVER",payload:c.data});break}}),D.useEffect(()=>{let c;return l.status==="QUESTION_ACTIVE"&&l.timer>0&&(c=setInterval(()=>{d({type:"TICK_TIMER"})},1e3)),()=>clearInterval(c)},[l.status,l.timer]),D.useEffect(()=>{(async()=>{try{const h=(await le.get(`/match/${b}/state`)).data;if(h.status==="active"&&h.currentQuestion){const O=Math.floor(Date.now()/1e3),j=h.currentQuestion.sent_at,_=O-j,N=Math.max(h.currentQuestion.time_limit-_,0);d({type:"NEW_QUESTION",payload:{...h.currentQuestion,time_limit:N}}),h.playerScores}}catch(y){console.error("Failed to sync state",y)}})()},[b]);const E=async()=>{try{await le.post(`/match/${b}/start`)}catch(c){console.error(c)}},o=async c=>{if(!l.hasAnswered){d({type:"PLAYER_ANSWERED",payload:c});try{await le.post(`/match/${b}/answer`,{question_id:l.currentQuestion?.question_id,answer_option:c})}catch(y){console.error(y)}}},v=async()=>{try{await le.post(`/match/${b}/next`)}catch(c){console.error(c)}};return{state:l,startGame:E,submitAnswer:o,nextQuestion:v}}var ce={};(function b(e,n,s,l){var d=!!(e.Worker&&e.Blob&&e.Promise&&e.OffscreenCanvas&&e.OffscreenCanvasRenderingContext2D&&e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype.transferControlToOffscreen&&e.URL&&e.URL.createObjectURL),E=typeof Path2D=="function"&&typeof DOMMatrix=="function",o=function(){if(!e.OffscreenCanvas)return!1;try{var r=new OffscreenCanvas(1,1),t=r.getContext("2d");t.fillRect(0,0,1,1);var i=r.transferToImageBitmap();t.createPattern(i,"no-repeat")}catch{return!1}return!0}();function v(){}function c(r){var t=n.exports.Promise,i=t!==void 0?t:e.Promise;return typeof i=="function"?new i(r):(r(v,v),null)}var y=function(r,t){return{transform:function(i){if(r)return i;if(t.has(i))return t.get(i);var u=new OffscreenCanvas(i.width,i.height),p=u.getContext("2d");return p.drawImage(i,0,0),t.set(i,u),u},clear:function(){t.clear()}}}(o,new Map),h=function(){var r=Math.floor(16.666666666666668),t,i,u={},p=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(t=function(x){var g=Math.random();return u[g]=requestAnimationFrame(function f(w){p===w||p+r-1<w?(p=w,delete u[g],x()):u[g]=requestAnimationFrame(f)}),g},i=function(x){u[x]&&cancelAnimationFrame(u[x])}):(t=function(x){return setTimeout(x,r)},i=function(x){return clearTimeout(x)}),{frame:t,cancel:i}}(),O=function(){var r,t,i={};function u(p){function x(g,f){p.postMessage({options:g||{},callback:f})}p.init=function(f){var w=f.transferControlToOffscreen();p.postMessage({canvas:w},[w])},p.fire=function(f,w,C){if(t)return x(f,null),t;var F=Math.random().toString(36).slice(2);return t=c(function(I){function L(Z){Z.data.callback===F&&(delete i[F],p.removeEventListener("message",L),t=null,y.clear(),C(),I())}p.addEventListener("message",L),x(f,F),i[F]=L.bind(null,{data:{callback:F}})}),t},p.reset=function(){p.postMessage({reset:!0});for(var f in i)i[f](),delete i[f]}}return function(){if(r)return r;if(!s&&d){var p=["var CONFETTI, SIZE = {}, module = {};","("+b.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{r=new Worker(URL.createObjectURL(new Blob([p])))}catch(x){return typeof console<"u"&&typeof console.warn=="function"&&console.warn("ðŸŽŠ Could not load worker",x),null}u(r)}return r}}(),j={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function _(r,t){return t?t(r):r}function N(r){return r!=null}function m(r,t,i){return _(r&&N(r[t])?r[t]:j[t],i)}function R(r){return r<0?0:Math.floor(r)}function A(r,t){return Math.floor(Math.random()*(t-r))+r}function M(r){return parseInt(r,16)}function T(r){return r.map(S)}function S(r){var t=String(r).replace(/[^0-9a-f]/gi,"");return t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),{r:M(t.substring(0,2)),g:M(t.substring(2,4)),b:M(t.substring(4,6))}}function U(r){var t=m(r,"origin",Object);return t.x=m(t,"x",Number),t.y=m(t,"y",Number),t}function V(r){r.width=document.documentElement.clientWidth,r.height=document.documentElement.clientHeight}function $(r){var t=r.getBoundingClientRect();r.width=t.width,r.height=t.height}function B(r){var t=document.createElement("canvas");return t.style.position="fixed",t.style.top="0px",t.style.left="0px",t.style.pointerEvents="none",t.style.zIndex=r,t}function z(r,t,i,u,p,x,g,f,w){r.save(),r.translate(t,i),r.rotate(x),r.scale(u,p),r.arc(0,0,1,g,f,w),r.restore()}function H(r){var t=r.angle*(Math.PI/180),i=r.spread*(Math.PI/180);return{x:r.x,y:r.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:r.startVelocity*.5+Math.random()*r.startVelocity,angle2D:-t+(.5*i-Math.random()*i),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:r.color,shape:r.shape,tick:0,totalTicks:r.ticks,decay:r.decay,drift:r.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:r.gravity*3,ovalScalar:.6,scalar:r.scalar,flat:r.flat}}function G(r,t){t.x+=Math.cos(t.angle2D)*t.velocity+t.drift,t.y+=Math.sin(t.angle2D)*t.velocity+t.gravity,t.velocity*=t.decay,t.flat?(t.wobble=0,t.wobbleX=t.x+10*t.scalar,t.wobbleY=t.y+10*t.scalar,t.tiltSin=0,t.tiltCos=0,t.random=1):(t.wobble+=t.wobbleSpeed,t.wobbleX=t.x+10*t.scalar*Math.cos(t.wobble),t.wobbleY=t.y+10*t.scalar*Math.sin(t.wobble),t.tiltAngle+=.1,t.tiltSin=Math.sin(t.tiltAngle),t.tiltCos=Math.cos(t.tiltAngle),t.random=Math.random()+2);var i=t.tick++/t.totalTicks,u=t.x+t.random*t.tiltCos,p=t.y+t.random*t.tiltSin,x=t.wobbleX+t.random*t.tiltCos,g=t.wobbleY+t.random*t.tiltSin;if(r.fillStyle="rgba("+t.color.r+", "+t.color.g+", "+t.color.b+", "+(1-i)+")",r.beginPath(),E&&t.shape.type==="path"&&typeof t.shape.path=="string"&&Array.isArray(t.shape.matrix))r.fill(Y(t.shape.path,t.shape.matrix,t.x,t.y,Math.abs(x-u)*.1,Math.abs(g-p)*.1,Math.PI/10*t.wobble));else if(t.shape.type==="bitmap"){var f=Math.PI/10*t.wobble,w=Math.abs(x-u)*.1,C=Math.abs(g-p)*.1,F=t.shape.bitmap.width*t.scalar,I=t.shape.bitmap.height*t.scalar,L=new DOMMatrix([Math.cos(f)*w,Math.sin(f)*w,-Math.sin(f)*C,Math.cos(f)*C,t.x,t.y]);L.multiplySelf(new DOMMatrix(t.shape.matrix));var Z=r.createPattern(y.transform(t.shape.bitmap),"no-repeat");Z.setTransform(L),r.globalAlpha=1-i,r.fillStyle=Z,r.fillRect(t.x-F/2,t.y-I/2,F,I),r.globalAlpha=1}else if(t.shape==="circle")r.ellipse?r.ellipse(t.x,t.y,Math.abs(x-u)*t.ovalScalar,Math.abs(g-p)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI):z(r,t.x,t.y,Math.abs(x-u)*t.ovalScalar,Math.abs(g-p)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI);else if(t.shape==="star")for(var k=Math.PI/2*3,K=4*t.scalar,X=8*t.scalar,ee=t.x,ae=t.y,se=5,re=Math.PI/se;se--;)ee=t.x+Math.cos(k)*X,ae=t.y+Math.sin(k)*X,r.lineTo(ee,ae),k+=re,ee=t.x+Math.cos(k)*K,ae=t.y+Math.sin(k)*K,r.lineTo(ee,ae),k+=re;else r.moveTo(Math.floor(t.x),Math.floor(t.y)),r.lineTo(Math.floor(t.wobbleX),Math.floor(p)),r.lineTo(Math.floor(x),Math.floor(g)),r.lineTo(Math.floor(u),Math.floor(t.wobbleY));return r.closePath(),r.fill(),t.tick<t.totalTicks}function q(r,t,i,u,p){var x=t.slice(),g=r.getContext("2d"),f,w,C=c(function(F){function I(){f=w=null,g.clearRect(0,0,u.width,u.height),y.clear(),p(),F()}function L(){s&&!(u.width===l.width&&u.height===l.height)&&(u.width=r.width=l.width,u.height=r.height=l.height),!u.width&&!u.height&&(i(r),u.width=r.width,u.height=r.height),g.clearRect(0,0,u.width,u.height),x=x.filter(function(Z){return G(g,Z)}),x.length?f=h.frame(L):I()}f=h.frame(L),w=I});return{addFettis:function(F){return x=x.concat(F),C},canvas:r,promise:C,reset:function(){f&&h.cancel(f),w&&w()}}}function Q(r,t){var i=!r,u=!!m(t||{},"resize"),p=!1,x=m(t,"disableForReducedMotion",Boolean),g=d&&!!m(t||{},"useWorker"),f=g?O():null,w=i?V:$,C=r&&f?!!r.__confetti_initialized:!1,F=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,I;function L(k,K,X){for(var ee=m(k,"particleCount",R),ae=m(k,"angle",Number),se=m(k,"spread",Number),re=m(k,"startVelocity",Number),ye=m(k,"decay",Number),we=m(k,"gravity",Number),Ne=m(k,"drift",Number),de=m(k,"colors",T),ke=m(k,"ticks",Number),ue=m(k,"shapes"),je=m(k,"scalar"),_e=!!m(k,"flat"),he=U(k),fe=ee,ie=[],Me=r.width*he.x,Ee=r.height*he.y;fe--;)ie.push(H({x:Me,y:Ee,angle:ae,spread:se,startVelocity:re,color:de[fe%de.length],shape:ue[A(0,ue.length)],ticks:ke,decay:ye,gravity:we,drift:Ne,scalar:je,flat:_e}));return I?I.addFettis(ie):(I=q(r,ie,w,K,X),I.promise)}function Z(k){var K=x||m(k,"disableForReducedMotion",Boolean),X=m(k,"zIndex",Number);if(K&&F)return c(function(re){re()});i&&I?r=I.canvas:i&&!r&&(r=B(X),document.body.appendChild(r)),u&&!C&&w(r);var ee={width:r.width,height:r.height};f&&!C&&f.init(r),C=!0,f&&(r.__confetti_initialized=!0);function ae(){if(f){var re={getBoundingClientRect:function(){if(!i)return r.getBoundingClientRect()}};w(re),f.postMessage({resize:{width:re.width,height:re.height}});return}ee.width=ee.height=null}function se(){I=null,u&&(p=!1,e.removeEventListener("resize",ae)),i&&r&&(document.body.contains(r)&&document.body.removeChild(r),r=null,C=!1)}return u&&!p&&(p=!0,e.addEventListener("resize",ae,!1)),f?f.fire(k,ee,se):L(k,ee,se)}return Z.reset=function(){f&&f.reset(),I&&I.reset()},Z}var P;function W(){return P||(P=Q(null,{useWorker:!0,resize:!0})),P}function Y(r,t,i,u,p,x,g){var f=new Path2D(r),w=new Path2D;w.addPath(f,new DOMMatrix(t));var C=new Path2D;return C.addPath(w,new DOMMatrix([Math.cos(g)*p,Math.sin(g)*p,-Math.sin(g)*x,Math.cos(g)*x,i,u])),C}function J(r){if(!E)throw new Error("path confetti are not supported in this browser");var t,i;typeof r=="string"?t=r:(t=r.path,i=r.matrix);var u=new Path2D(t),p=document.createElement("canvas"),x=p.getContext("2d");if(!i){for(var g=1e3,f=g,w=g,C=0,F=0,I,L,Z=0;Z<g;Z+=2)for(var k=0;k<g;k+=2)x.isPointInPath(u,Z,k,"nonzero")&&(f=Math.min(f,Z),w=Math.min(w,k),C=Math.max(C,Z),F=Math.max(F,k));I=C-f,L=F-w;var K=10,X=Math.min(K/I,K/L);i=[X,0,0,X,-Math.round(I/2+f)*X,-Math.round(L/2+w)*X]}return{type:"path",path:t,matrix:i}}function te(r){var t,i=1,u="#000000",p='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof r=="string"?t=r:(t=r.text,i="scalar"in r?r.scalar:i,p="fontFamily"in r?r.fontFamily:p,u="color"in r?r.color:u);var x=10*i,g=""+x+"px "+p,f=new OffscreenCanvas(x,x),w=f.getContext("2d");w.font=g;var C=w.measureText(t),F=Math.ceil(C.actualBoundingBoxRight+C.actualBoundingBoxLeft),I=Math.ceil(C.actualBoundingBoxAscent+C.actualBoundingBoxDescent),L=2,Z=C.actualBoundingBoxLeft+L,k=C.actualBoundingBoxAscent+L;F+=L+L,I+=L+L,f=new OffscreenCanvas(F,I),w=f.getContext("2d"),w.font=g,w.fillStyle=u,w.fillText(t,Z,k);var K=1/i;return{type:"bitmap",bitmap:f.transferToImageBitmap(),matrix:[K,0,0,K,-F*K/2,-I*K/2]}}n.exports=function(){return W().apply(this,arguments)},n.exports.reset=function(){W().reset()},n.exports.create=Q,n.exports.shapeFromPath=J,n.exports.shapeFromText=te})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),ce,!1);const We=ce.exports;ce.exports.create;function Xe(b){const e=ne.c(5),{match:n}=b,s=`match:${n.channel_id}`;let l;e[0]!==n?(l=a.jsx(me,{channelName:"global-presence",children:a.jsx(Be,{match:n})}),e[0]=n,e[1]=l):l=e[1];let d;return e[2]!==s||e[3]!==l?(d=a.jsx(me,{channelName:s,children:l}),e[2]=s,e[3]=l,e[4]=d):d=e[4],d}function Be(b){const e=ne.c(54),{match:n}=b,s=Ce().props.auth.user,{t:l}=oe(),d=n.player1_id===s.id?n.player2:n.player1,E=Number(n.player1_id)===Number(s.id),{state:o,submitAnswer:v}=Ue(n.id,n.channel_id,s.id,E),c=o.opponent||d;Oe(`match:${n.channel_id}`);const{presenceData:y}=Pe(`match:${n.channel_id}`),[h,O]=D.useState(!1);let j;e[0]!==c?.id||e[1]!==y?(j=()=>{const te=y.some(r=>r.clientId===String(c?.id));O(te)},e[0]=c?.id,e[1]=y,e[2]=j):j=e[2];let _;e[3]!==c||e[4]!==y?(_=[y,c],e[3]=c,e[4]=y,e[5]=_):_=e[5],D.useEffect(j,_);const{channel:N}=ve("global-presence");let m;e[6]!==N||e[7]!==s.id||e[8]!==s.name||e[9]!==s.profile_photo_url?(m=()=>{if(N)return N.presence.update({name:s.name,id:s.id,profile_photo_url:s.profile_photo_url,status:"playing"}),()=>{N.presence.update({name:s.name,id:s.id,profile_photo_url:s.profile_photo_url,status:"online"})}},e[6]=N,e[7]=s.id,e[8]=s.name,e[9]=s.profile_photo_url,e[10]=m):m=e[10];let R;e[11]!==N||e[12]!==s?(R=[N,s],e[11]=N,e[12]=s,e[13]=R):R=e[13],D.useEffect(m,R);const A=o.timer,M=o.currentQuestion,T=o.playerScores[n.player1_id===s.id?"p1":"p2"],S=o.playerScores[n.player1_id===s.id?"p2":"p1"],U=o.winnerId===s.id,V=o.status==="GAME_OVER"&&!o.winnerId;let $;e[14]===Symbol.for("react.memo_cache_sentinel")?($=a.jsx(Re,{title:"Arena"}),e[14]=$):$=e[14];let B;e[15]===Symbol.for("react.memo_cache_sentinel")?(B=a.jsx("div",{className:"absolute top-4 right-4 z-50 hidden md:block",children:a.jsx(Ie,{})}),e[15]=B):B=e[15];let z;e[16]===Symbol.for("react.memo_cache_sentinel")?(z=a.jsxs("div",{className:"pointer-events-none absolute inset-0 overflow-hidden",children:[a.jsx("div",{className:"absolute top-[-10%] left-[-10%] h-[500px] w-[500px] animate-pulse rounded-full bg-blue-500/20 blur-[100px]"}),a.jsx("div",{className:"absolute right-[-10%] bottom-[-10%] h-[500px] w-[500px] animate-pulse rounded-full bg-purple-500/20 blur-[100px] delay-700"})]}),e[16]=z):z=e[16];const H=M?.round_index;let G;e[17]!==c||e[18]!==h||e[19]!==S||e[20]!==T||e[21]!==o.status||e[22]!==H||e[23]!==A||e[24]!==s?(G=a.jsx(Fe,{user:s,opponent:c,score:T,opponentScore:S,timer:A,currentQuestionIndex:H,status:o.status,opponentPresent:h}),e[17]=c,e[18]=h,e[19]=S,e[20]=T,e[21]=o.status,e[22]=H,e[23]=A,e[24]=s,e[25]=G):G=e[25];let q;e[26]!==o.status||e[27]!==l?(q=o.status==="WAITING_FOR_OPPONENT"&&a.jsxs("div",{className:"animate-in fade-in md:p6 flex flex-1 flex-col items-center justify-center space-y-8 p-4 text-center duration-700 md:p-6",children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"h-24 w-24 rounded-full border-4 border-slate-200 dark:border-slate-800"}),a.jsx("div",{className:"absolute inset-0 h-24 w-24 animate-spin rounded-full border-t-4 border-blue-500"}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsx("svg",{className:"h-8 w-8 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold md:text-3xl",children:l("Searching for Opponent")}),a.jsx("p",{className:"mt-2 text-slate-500 dark:text-slate-400",children:l("Connecting to global matchmaking server...")})]})]}),e[26]=o.status,e[27]=l,e[28]=q):q=e[28];let Q;e[29]!==o.status||e[30]!==l?(Q=o.status==="STARTING"&&a.jsxs("div",{className:"animate-in zoom-in flex flex-1 flex-col items-center justify-center space-y-6 p-8 text-center duration-500",children:[a.jsx("div",{className:"mb-4 text-6xl md:text-8xl",children:"âš”ï¸"}),a.jsx("h1",{className:"animate-bounce bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-4xl font-black text-transparent md:text-6xl dark:from-blue-400 dark:to-purple-500",children:l("MATCH FOUND!")}),a.jsx("p",{className:"text-xl text-slate-600 dark:text-slate-300",children:l("Get Ready...")})]}),e[29]=o.status,e[30]=l,e[31]=Q):Q=e[31];let P;e[32]!==M||e[33]!==o.hasAnswered||e[34]!==o.lastRoundResult||e[35]!==o.opponentAnswered||e[36]!==o.status||e[37]!==o.userAnswer||e[38]!==v?(P=(o.status==="QUESTION_ACTIVE"||o.status==="ROUND_RESULT")&&M&&a.jsx(Qe,{currentQuestion:M,status:o.status,lastRoundResult:o.lastRoundResult,hasAnswered:o.hasAnswered,opponentAnswered:o.opponentAnswered,submitAnswer:v,userAnswer:o.userAnswer}),e[32]=M,e[33]=o.hasAnswered,e[34]=o.lastRoundResult,e[35]=o.opponentAnswered,e[36]=o.status,e[37]=o.userAnswer,e[38]=v,e[39]=P):P=e[39];let W;e[40]!==V||e[41]!==U||e[42]!==S||e[43]!==T||e[44]!==o.status?(W=o.status==="GAME_OVER"&&a.jsx(Ve,{score:T,opponentScore:S,isWinner:U,isDraw:V}),e[40]=V,e[41]=U,e[42]=S,e[43]=T,e[44]=o.status,e[45]=W):W=e[45];let Y;e[46]!==q||e[47]!==Q||e[48]!==P||e[49]!==W?(Y=a.jsx("div",{className:"z-10 flex w-full max-w-4xl flex-1 flex-col justify-center p-2 md:p-4",children:a.jsxs("div",{className:"relative flex min-h-[400px] flex-col overflow-hidden rounded-3xl border border-slate-200 bg-white/80 shadow-2xl backdrop-blur-xl transition-all duration-500 md:min-h-[500px] dark:border-white/10 dark:bg-slate-900/60",children:[q,Q,P,W]})}),e[46]=q,e[47]=Q,e[48]=P,e[49]=W,e[50]=Y):Y=e[50];let J;return e[51]!==Y||e[52]!==G?(J=a.jsxs("div",{className:"relative flex min-h-screen flex-col items-center overflow-hidden bg-slate-50 font-sans text-slate-900 transition-colors duration-300 selection:bg-blue-500 selection:text-white dark:bg-slate-950 dark:text-white",children:[$,B,z,G,Y]}),e[51]=Y,e[52]=G,e[53]=J):J=e[53],J}const Qe=D.memo(b=>{const e=ne.c(39),{currentQuestion:n,status:s,lastRoundResult:l,hasAnswered:d,opponentAnswered:E,submitAnswer:o,userAnswer:v}=b,{t:c,i18n:y}=oe(),h=y.language==="my",O=h&&n.text_my?n.text_my:n.text,j=h&&n.options_my?n.options_my:n.options,_=$e;let N,m;e[0]!==d||e[1]!==l||e[2]!==s||e[3]!==v?(N=()=>{s==="ROUND_RESULT"&&l&&d&&(l.correct_option===v?new Audio("/sounds/correct.mp3").play().catch(Ge):new Audio("/sounds/wrong.mp3").play().catch(ze))},m=[s,l,d,v],e[0]=d,e[1]=l,e[2]=s,e[3]=v,e[4]=N,e[5]=m):(N=e[4],m=e[5]),D.useEffect(N,m);let R;e[6]===Symbol.for("react.memo_cache_sentinel")?(R=a.jsx("div",{className:"animate-gradient-x absolute top-0 left-0 h-1 w-full bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500"}),e[6]=R):R=e[6];let A;e[7]!==n.category?(A=a.jsx("span",{className:"mb-4 inline-block rounded-full bg-blue-100 px-4 py-1 text-xs font-bold tracking-widest text-blue-700 uppercase dark:bg-blue-900/30 dark:text-blue-300",children:n.category}),e[7]=n.category,e[8]=A):A=e[8];let M;e[9]!==O?(M=a.jsx("h2",{className:"text-2xl font-black tracking-tight text-slate-800 md:text-4xl md:leading-snug dark:text-slate-100",children:O}),e[9]=O,e[10]=M):M=e[10];let T;e[11]!==A||e[12]!==M?(T=a.jsxs("div",{className:"relative mb-8 overflow-hidden rounded-2xl bg-gradient-to-br from-indigo-500/10 to-purple-500/10 p-1 shadow-lg backdrop-blur-md dark:from-indigo-500/5 dark:to-purple-500/5",children:[R,a.jsxs("div",{className:"relative rounded-xl bg-white/50 p-6 text-center md:p-10 dark:bg-slate-900/50",children:[A,M]})]}),e[11]=A,e[12]=M,e[13]=T):T=e[13];let S;if(e[14]!==n.options||e[15]!==j||e[16]!==d||e[17]!==l?.correct_option||e[18]!==s||e[19]!==o||e[20]!==v){let B;e[22]!==n.options||e[23]!==d||e[24]!==l?.correct_option||e[25]!==s||e[26]!==o||e[27]!==v?(B=(z,H)=>{const G=v===z,q=l?.correct_option===z,Q=s==="ROUND_RESULT";let P="border-slate-200 bg-white/80 text-slate-700 hover:border-blue-400 hover:bg-blue-50/50 dark:border-slate-700 dark:bg-slate-800/80 dark:text-slate-200 dark:hover:border-blue-500 dark:hover:bg-blue-900/20",W=a.jsx("span",{className:"flex h-8 w-8 items-center justify-center rounded-lg border border-current text-sm font-bold opacity-70 transition-all group-hover:border-transparent group-hover:bg-current group-hover:text-white",children:String.fromCharCode(65+H)});return d&&(P="border-slate-200 bg-slate-50 text-slate-400 cursor-default dark:border-slate-800 dark:bg-slate-900/50 dark:text-slate-600",G&&(P="border-blue-500 bg-blue-100/50 text-blue-700 dark:border-blue-500 dark:bg-blue-900/30 dark:text-blue-300",W=a.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-blue-500 text-white",children:a.jsxs("svg",{className:"h-5 w-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}))),Q&&(q?(P="border-green-500 bg-green-100 text-green-800 shadow-[0_0_20px_rgba(34,197,94,0.3)] scale-[1.02] z-10 dark:border-green-500 dark:bg-green-900/30 dark:text-green-300",W=a.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-green-500 text-white",children:a.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})):G?(P="border-red-500 bg-red-100 text-red-800 opacity-80 dark:border-red-500 dark:bg-red-900/30 dark:text-red-300",W=a.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-red-500 text-white",children:a.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 18L18 6M6 6l12 12"})})})):P="grayscale opacity-50 border-slate-200 bg-slate-50 dark:border-slate-800 dark:bg-slate-900/50"),a.jsxs("button",{onClick:()=>o(n.options[H]),disabled:d||Q,className:`group relative flex items-center gap-4 overflow-hidden rounded-2xl border-2 p-5 text-left shadow-sm transition-all duration-300 ${P}`,style:{animationDelay:_(H)},children:[a.jsx("div",{className:"shrink-0",children:W}),a.jsx("span",{className:"text-lg font-bold tracking-tight md:text-xl",children:z}),!d&&!Q&&a.jsx("div",{className:"absolute inset-0 translate-x-[-100%] -skew-x-12 bg-gradient-to-r from-transparent via-white/20 to-transparent opacity-0 transition-opacity duration-300 group-hover:translate-x-[100%] group-hover:opacity-100"})]},H)},e[22]=n.options,e[23]=d,e[24]=l?.correct_option,e[25]=s,e[26]=o,e[27]=v,e[28]=B):B=e[28],S=j.map(B),e[14]=n.options,e[15]=j,e[16]=d,e[17]=l?.correct_option,e[18]=s,e[19]=o,e[20]=v,e[21]=S}else S=e[21];let U;e[29]!==S?(U=a.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 md:gap-6",children:S}),e[29]=S,e[30]=U):U=e[30];let V;e[31]!==l||e[32]!==E||e[33]!==c?(V=E&&!l&&a.jsx("div",{className:"mt-8 flex justify-center",children:a.jsxs("div",{className:"flex animate-pulse items-center gap-2 rounded-full bg-red-100 px-4 py-2 text-sm font-bold text-red-600 dark:bg-red-900/30 dark:text-red-400",children:[a.jsxs("span",{className:"relative flex h-3 w-3",children:[a.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-red-400 opacity-75"}),a.jsx("span",{className:"relative inline-flex h-3 w-3 rounded-full bg-red-500"})]}),c("Opponent has answered!")]})}),e[31]=l,e[32]=E,e[33]=c,e[34]=V):V=e[34];let $;return e[35]!==T||e[36]!==U||e[37]!==V?($=a.jsxs("div",{className:"mx-auto flex w-full max-w-4xl flex-1 flex-col p-4 md:p-8",children:[T,U,V]}),e[35]=T,e[36]=U,e[37]=V,e[38]=$):$=e[38],$}),Ve=D.memo(b=>{const e=ne.c(33),{score:n,opponentScore:s,isWinner:l,isDraw:d}=b,{t:E}=oe();let o,v;e[0]!==d||e[1]!==l?(o=()=>{l?(new Audio("/sounds/victory.mp3").play().catch(He),We({particleCount:150,spread:70,origin:{y:.6},colors:["#3b82f6","#8b5cf6","#10b981","#f59e0b"]})):d||new Audio("/sounds/defeat.mp3").play().catch(qe)},v=[l,d],e[0]=d,e[1]=l,e[2]=o,e[3]=v):(o=e[2],v=e[3]),D.useEffect(o,v);let c;e[4]!==E?(c=E("GAME OVER"),e[4]=E,e[5]=c):c=e[5];let y;e[6]!==c?(y=a.jsx("h1",{className:"text-4xl font-black tracking-tight text-slate-900 uppercase md:text-6xl dark:text-white",children:c}),e[6]=c,e[7]=y):y=e[7];let h;e[8]!==n?(h=a.jsx("div",{className:"text-5xl font-black",children:n}),e[8]=n,e[9]=h):h=e[9];let O;e[10]===Symbol.for("react.memo_cache_sentinel")?(O=a.jsx("div",{className:"text-sm",children:"YOU"}),e[10]=O):O=e[10];let j;e[11]!==h?(j=a.jsxs("div",{className:"flex flex-col items-center",children:[h,O]}),e[11]=h,e[12]=j):j=e[12];let _;e[13]!==s?(_=a.jsx("div",{className:"text-5xl font-black",children:s}),e[13]=s,e[14]=_):_=e[14];let N;e[15]===Symbol.for("react.memo_cache_sentinel")?(N=a.jsx("div",{className:"text-sm",children:"OPPONENT"}),e[15]=N):N=e[15];let m;e[16]!==_?(m=a.jsxs("div",{className:"flex flex-col items-center",children:[_,N]}),e[16]=_,e[17]=m):m=e[17];let R;e[18]!==m||e[19]!==j?(R=a.jsxs("div",{className:"flex w-full items-end justify-center gap-8 md:gap-16",children:[j,m]}),e[18]=m,e[19]=j,e[20]=R):R=e[20];let A;e[21]!==d||e[22]!==l?(A=a.jsx("div",{className:"pt-8 text-3xl font-bold",children:l?a.jsx("span",{className:"text-green-500",children:"VICTORY!"}):d?a.jsx("span",{className:"text-yellow-500",children:"DRAW"}):a.jsx("span",{className:"text-red-500",children:"DEFEAT"})}),e[21]=d,e[22]=l,e[23]=A):A=e[23];let M;e[24]!==E?(M=E("Back to Lobby"),e[24]=E,e[25]=M):M=e[25];let T;e[26]!==M?(T=a.jsx("button",{onClick:Ze,className:"rounded-2xl bg-slate-900 px-8 py-4 font-bold text-white shadow-xl hover:scale-105 dark:bg-white dark:text-slate-900",children:M}),e[26]=M,e[27]=T):T=e[27];let S;return e[28]!==R||e[29]!==A||e[30]!==T||e[31]!==y?(S=a.jsxs("div",{className:"animate-in zoom-in flex flex-1 flex-col items-center justify-center space-y-8 p-8 text-center duration-500",children:[y,R,A,T]}),e[28]=R,e[29]=A,e[30]=T,e[31]=y,e[32]=S):S=e[32],S});function $e(b){return`${b*10}ms`}function Ge(){}function ze(){}function He(b){return console.log("Audio play failed",b)}function qe(b){return console.log("Audio play failed",b)}function Ze(){return window.location.href="/lobby"}export{Xe as default};
